<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
    
    <title>Analysis</title>

        <script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
        <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="site_libs/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="site_libs/readthedown-0.1/readthedown.js"></script>
        <link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
        <script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
        <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
        <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {  background-color: #f8f8f8; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span.al { color: #ef2929; } /* Alert */
      code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #c4a000; } /* Attribute */
      code span.bn { color: #0000cf; } /* BaseN */
      code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4e9a06; } /* Char */
      code span.cn { color: #000000; } /* Constant */
      code span.co { color: #8f5902; font-style: italic; } /* Comment */
      code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
      code span.dt { color: #204a87; } /* DataType */
      code span.dv { color: #0000cf; } /* DecVal */
      code span.er { color: #a40000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #0000cf; } /* Float */
      code span.fu { color: #000000; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
      code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
      code span.ot { color: #8f5902; } /* Other */
      code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
      code span.sc { color: #000000; } /* SpecialChar */
      code span.ss { color: #4e9a06; } /* SpecialString */
      code span.st { color: #4e9a06; } /* String */
      code span.va { color: #000000; } /* Variable */
      code span.vs { color: #4e9a06; } /* VerbatimString */
      code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    </style>
    
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
   
      
      <div class="navbar navbar-default  navbar-fixed-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">Lights, camera, pliman!</a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li>
        <a href="index.html">
          <span class="fa fa-home"></span>
           
          About
        </a>
      </li>
      <li>
        <a href="code.html">
          <span class="fa fa-file-code-o"></span>
           
          Analysis
        </a>
      </li>
      <li>
        <a href="https://github.com/TiagoOlivoto/paper_pliman/archive/refs/heads/master.zip">
          <span class="fa fa-download"></span>
           
          Code and data
        </a>
      </li>
      <li>
        <a href="https://doi.org/10.5281/zenodo.5666820">
          <span class="ai ai ai ai-doi ai"></span>
           
          Doi
        </a>
      </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li>
        <a href="https://github.com/TiagoOlivoto/paper_pliman">
          <span class="fa fa-github"></span>
           
          Material
        </a>
      </li>
      <li>
        <a href="https://github.com/TiagoOlivoto/pliman">
          <span class="fa fa-github"></span>
           
          Package
        </a>
      </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container -->
      </div><!--/.navbar -->
        
      <h1 class="title">Analysis</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Analysis</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#packages"><span class="toc-section-number">1</span> Packages</a></li>
      <li><a href="#installing-pliman"><span class="toc-section-number">2</span> Installing pliman</a></li>
      <li><a href="#helper-functions"><span class="toc-section-number">3</span> Helper functions</a></li>
      <li><a href="#image-manipulation"><span class="toc-section-number">4</span> Image manipulation</a>
      <ul>
      <li><a href="#importing-images"><span class="toc-section-number">4.1</span> Importing images</a></li>
      <li><a href="#displaying-images"><span class="toc-section-number">4.2</span> Displaying images</a></li>
      <li><a href="#manipulating-images"><span class="toc-section-number">4.3</span> Manipulating images</a>
      <ul>
      <li><a href="#resize-an-image"><span class="toc-section-number">4.3.1</span> Resize an image</a></li>
      <li><a href="#crop-an-image"><span class="toc-section-number">4.3.2</span> Crop an image</a></li>
      <li><a href="#dpi"><span class="toc-section-number">4.3.3</span> Image resolution (DPI)</a></li>
      <li><a href="#rotate-an-image"><span class="toc-section-number">4.3.4</span> Rotate an image</a></li>
      <li><a href="#horizontal-and-vertical-reflection"><span class="toc-section-number">4.3.5</span> Horizontal and vertical reflection</a></li>
      <li><a href="#horizontal-and-vertical-conversion"><span class="toc-section-number">4.3.6</span> Horizontal and vertical conversion</a></li>
      <li><a href="#filter-blur-contrast-dilatation-and-erosion"><span class="toc-section-number">4.3.7</span> Filter, blur, contrast, dilatation, and erosion</a></li>
      <li><a href="#exporting-images"><span class="toc-section-number">4.3.8</span> Exporting images</a></li>
      <li><a href="#combining-functions"><span class="toc-section-number">4.3.9</span> Combining functions</a></li>
      </ul></li>
      </ul></li>
      <li><a href="#image-segmentation"><span class="toc-section-number">5</span> Image segmentation</a>
      <ul>
      <li><a href="#segment-an-image"><span class="toc-section-number">5.1</span> Segment an image</a></li>
      <li><a href="#iterative-segmentation"><span class="toc-section-number">5.2</span> Iterative segmentation</a></li>
      </ul></li>
      <li><a href="#producing-a-binary-image"><span class="toc-section-number">6</span> Producing a binary image</a></li>
      <li><a href="#count-objects"><span class="toc-section-number">7</span> Count objects</a>
      <ul>
      <li><a href="#check-the-better-index-to-segment-the-image"><span class="toc-section-number">7.1</span> Check the better index to segment the image</a></li>
      <li><a href="#concordance"><span class="toc-section-number">7.2</span> Concordance</a></li>
      <li><a href="#source-of-errors"><span class="toc-section-number">7.3</span> Source of errors</a></li>
      <li><a href="#benchmarking"><span class="toc-section-number">7.4</span> Benchmarking</a></li>
      <li><a href="#a-little-bit-more"><span class="toc-section-number">7.5</span> A little bit more</a>
      <ul>
      <li><a href="#cells"><span class="toc-section-number">7.5.1</span> Cells</a></li>
      <li><a href="#pollen"><span class="toc-section-number">7.5.2</span> Pollen</a></li>
      </ul></li>
      </ul></li>
      <li><a href="#object-features"><span class="toc-section-number">8</span> Object features</a></li>
      <li><a href="#root-length"><span class="toc-section-number">9</span> Root length</a></li>
      <li><a href="#leaf-area"><span class="toc-section-number">10</span> Leaf area</a>
      <ul>
      <li><a href="#objectsize"><span class="toc-section-number">10.1</span> Using an object of known area</a></li>
      <li><a href="#knowing-the-image-resolution-in-dpi-dots-per-inch"><span class="toc-section-number">10.2</span> knowing the image resolution in dpi (dots per inch)</a></li>
      <li><a href="#comparing-pliman-and-leafarea"><span class="toc-section-number">10.3</span> Comparing <code>pliman</code> and <code>LeafArea</code></a></li>
      <li><a href="#variations-in-the-arguments-of-analyze_objects"><span class="toc-section-number">10.4</span> Variations in the arguments of <code>analyze_objects()</code></a></li>
      </ul></li>
      <li><a href="#leaf-shape"><span class="toc-section-number">11</span> Leaf shape</a>
      <ul>
      <li><a href="#object-contour"><span class="toc-section-number">11.1</span> Object contour</a></li>
      <li><a href="#convex-hull"><span class="toc-section-number">11.2</span> Convex hull</a></li>
      <li><a href="#area-of-the-convex-hull"><span class="toc-section-number">11.3</span> Area of the convex hull</a></li>
      <li><a href="#leaves-as-ggplot2-plot"><span class="toc-section-number">11.4</span> Leaves as <code>ggplot2</code> plot</a></li>
      </ul></li>
      <li><a href="#simple-and-compound-leaves"><span class="toc-section-number">12</span> Simple and compound leaves</a>
      <ul>
      <li><a href="#simple-leaves"><span class="toc-section-number">12.1</span> Simple leaves</a></li>
      <li><a href="#compound-leaves"><span class="toc-section-number">12.2</span> Compound leaves</a></li>
      </ul></li>
      <li><a href="#several-images-of-the-same-sample"><span class="toc-section-number">13</span> Several images of the same sample</a>
      <ul>
      <li><a href="#compute-the-measures-for-the-subsamples"><span class="toc-section-number">13.1</span> Compute the measures for the subsamples</a></li>
      <li><a href="#compute-the-measures-for-the-whole-images"><span class="toc-section-number">13.2</span> Compute the measures for the whole images</a></li>
      <li><a href="#area-and-solidity-for-different-species"><span class="toc-section-number">13.3</span> Area and solidity for different species</a></li>
      </ul></li>
      <li><a href="#rgb-values-for-each-object"><span class="toc-section-number">14</span> RGB values for each object</a>
      <ul>
      <li><a href="#plot-the-index"><span class="toc-section-number">14.1</span> Plot the index</a></li>
      <li><a href="#large-number-of-objects"><span class="toc-section-number">14.2</span> Large number of objects</a></li>
      </ul></li>
      <li><a href="#object-identification-id"><span class="toc-section-number">15</span> Object identification (id)</a></li>
      <li><a href="#object-coordinates"><span class="toc-section-number">16</span> Object coordinates</a></li>
      <li><a href="#isolating-objects"><span class="toc-section-number">17</span> Isolating objects</a></li>
      <li><a href="#phytopathometry"><span class="toc-section-number">18</span> Phytopathometry</a>
      <ul>
      <li><a href="#single-images"><span class="toc-section-number">18.1</span> Single images</a></li>
      <li><a href="#image-palettes"><span class="toc-section-number">18.2</span> Image palettes</a></li>
      <li><a href="#variations-in-image-palettes"><span class="toc-section-number">18.3</span> Variations in image palettes</a></li>
      <li><a href="#batch-processing"><span class="toc-section-number">18.4</span> Batch processing</a>
      <ul>
      <li><a href="#soybean-rust"><span class="toc-section-number">18.4.1</span> Soybean rust</a></li>
      <li><a href="#bean-angular-spot"><span class="toc-section-number">18.4.2</span> Bean angular spot</a></li>
      </ul></li>
      <li><a href="#concordance-correlation-coefficient"><span class="toc-section-number">18.5</span> Concordance correlation coefficient</a></li>
      <li><a href="#lesion-features"><span class="toc-section-number">18.6</span> Lesion features</a></li>
      <li><a href="#benchmarking-1"><span class="toc-section-number">18.7</span> Benchmarking</a></li>
      <li><a href="#challenges"><span class="toc-section-number">18.8</span> Challenges</a>
      <ul>
      <li><a href="#low-contrasting-lesions"><span class="toc-section-number">18.8.1</span> low-contrasting lesions</a></li>
      <li><a href="#complex-backgrounds"><span class="toc-section-number">18.8.2</span> Complex backgrounds</a></li>
      </ul></li>
      </ul></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<div id="packages" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Packages</h1>
<p>To reproduce the examples of this material, the following packages are needed.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)  <span class="co"># data manipulation and plots</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">## v ggplot2 3.3.5     v purrr   0.3.4</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">## v tibble  3.1.4     v dplyr   1.0.7</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">## v tidyr   1.1.3     v stringr 1.4.0</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">## v readr   2.0.2     v forcats 0.5.1</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">## -- Conflicts ------------------------------------------ tidyverse_conflicts() --</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">## x dplyr::filter() masks stats::filter()</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">## x dplyr::lag()    masks stats::lag()</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)     <span class="co"># plant image analysis</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">## |=======================================================|</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="do">## | Tools for Plant Image Analysis (pliman 1.0.0)         |</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">## | Author: Tiago Olivoto                                 |</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="do">## | Type &#39;vignette(&#39;pliman_start&#39;)&#39; for a short tutorial  |</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="do">## | Visit &#39;https://bit.ly/pliman&#39; for a complete tutorial |</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="do">## |=======================================================|</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)  <span class="co"># concordance correlation coefficient</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rio)        <span class="co"># import/export data</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(LeafArea)   <span class="co"># leaf area</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)    <span class="co"># plots</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggh4x)      <span class="co"># plots</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)     <span class="co"># pairwise correlation plots</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Registered S3 method overwritten by &#39;GGally&#39;:</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="do">##   method from   </span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="do">##   +.gg   ggplot2</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)  <span class="co"># arrange plots</span></span></code></pre></div>
</div>
<div id="installing-pliman" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Installing pliman</h1>
<p>To install the released version of <code>pliman</code> from CRAN type:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;pliman&quot;</span>)</span></code></pre></div>
<p>The latest development version of <code>pliman</code> can be installed from the GitHub repository. The installation process requires the <code>devtools</code> package, which needs to be installed first. If you are a Windows user, you should also first download and install the latest version of <a href="https://cran.r-project.org/bin/windows/Rtools/">Rtools</a>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(devtools)) <span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span></code></pre></div>
<p>After <code>devtools</code> is properly installed, you can install <code>pliman</code> by running the following code. Please, note that the installation will also download the dependencies required to run the package.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;TiagoOlivoto/pliman&quot;</span>)</span></code></pre></div>
<p>Them, load <code>pliman</code> by running</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pliman)</span></code></pre></div>
</div>
<div id="helper-functions" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Helper functions</h1>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># helper function to compute concordance statistics</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>get_ccc <span class="ot">&lt;-</span> <span class="cf">function</span>(df, predicted, real){</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.grouped_df</span>(df)){</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_modify</span>(<span class="sc">~</span><span class="fu">get_ccc</span>(.x, {{predicted}}, {{real}})) <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ungroup</span>()</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span>{</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    predicted <span class="ot">&lt;-</span> <span class="fu">pull</span>(df, {{predicted}})</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    real <span class="ot">&lt;-</span> <span class="fu">pull</span>(df, {{real}})</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    cor <span class="ot">&lt;-</span> <span class="fu">CCC</span>(real, predicted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="at">r =</span> <span class="fu">cor</span>(real, predicted, <span class="at">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">pc =</span> cor<span class="sc">$</span>rho.c[[<span class="dv">1</span>]],</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">lwr_ci =</span> cor<span class="sc">$</span>rho.c[[<span class="dv">2</span>]],</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">upr_ci =</span> cor<span class="sc">$</span>rho.c[[<span class="dv">3</span>]],</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">bc =</span> cor<span class="sc">$</span>C.b)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># helper function to plot the CCC in ggpairs()</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>custom_ccc <span class="ot">&lt;-</span> <span class="cf">function</span>(data, mapping,...){</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  data2 <span class="ot">&lt;-</span> data</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  data2<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data[,<span class="fu">as_label</span>(mapping<span class="sc">$</span>x)])</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  data2<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data[,<span class="fu">as_label</span>(mapping<span class="sc">$</span>y)])</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  data2<span class="sc">$</span>group <span class="ot">&lt;-</span> data[,<span class="fu">as_label</span>(mapping<span class="sc">$</span>colour)]</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  correlation_df <span class="ot">&lt;-</span> data2 <span class="sc">%&gt;%</span> </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">estimate =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(DescTools<span class="sc">::</span><span class="fu">CCC</span>(x, y)<span class="sc">$</span>rho.c[<span class="dv">1</span>]),<span class="dv">3</span>))</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>correlation_df, <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>group, <span class="at">color =</span> group))<span class="sc">+</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&quot;rho[c]: &quot;</span>, estimate)),</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> correlation_df,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">4</span>)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>custom_smoth <span class="ot">&lt;-</span> <span class="cf">function</span>(data, mapping, <span class="at">method=</span><span class="st">&quot;lm&quot;</span>, ...){</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> data, <span class="at">mapping =</span> mapping) <span class="sc">+</span> </span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">intercept =</span> <span class="dv">0</span>,</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">0.7</span>,</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">slope =</span> <span class="dv">1</span>,</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">2.5</span>,</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>               <span class="at">stroke =</span> <span class="dv">0</span>,</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) </span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>  p</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot theme</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>my_theme <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_grey</span>() <span class="sc">%+%</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.box.margin=</span><span class="fu">margin</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="sc">-</span><span class="dv">10</span>,<span class="sc">-</span><span class="dv">10</span>,<span class="sc">-</span><span class="dv">10</span>),</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>))</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="image-manipulation" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Image manipulation</h1>
<div id="importing-images" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Importing images</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>soy <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;./data/soy_grains.jpg&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>soy2 <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;./data/soy_grains_2.jpg&quot;</span>)</span></code></pre></div>
<p>To import a list of images, the argument <code>pattern</code> of the function <code>image_import()</code> is used. All images that match the pattern name are imported into a list.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>soy_list <span class="ot">&lt;-</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">&quot;soy_&quot;</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">path =</span> <span class="st">&quot;./data&quot;</span>) <span class="co"># choose path directory</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(soy_list)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;soy_grains.jpg&quot;   &quot;soy_grains_2.JPG&quot;</span></span></code></pre></div>
</div>
<div id="displaying-images" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Displaying images</h2>
<p>Single images are displayed with <code>plot()</code>. For combining images, the function <code>image_combine()</code> is used. Users can inform either a comma-separated list of objects or a list of objects of class <code>Image</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Single images</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(soy)</span></code></pre></div>
<p><img src="code_files/figure-html/display1-1.png" width="1152" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine images</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(soy, soy2)</span></code></pre></div>
<p><img src="code_files/figure-html/display2-1.png" width="1152" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine images</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(soy_list)</span></code></pre></div>
<p><img src="code_files/figure-html/display2-2.png" width="1152" /></p>
</div>
<div id="manipulating-images" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Manipulating images</h2>
<p><code>pliman</code> provides a set of <code>image_*()</code> functions to perform image manipulation and transformation of unique images or a list of images based on the <a href="https://www.bioconductor.org/packages/release/bioc/vignettes/EBImage/inst/doc/EBImage-introduction.html">EBImage package</a>.</p>
<div id="resize-an-image" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Resize an image</h3>
<p>Sometimes resizing of high-resolution images is needed to reduce the processing time. The function <code>image_resize()</code> is used to resize an image. The argument <code>rel_size</code> can be used to resize the image by relative size. For example, by setting <code>rel_size = 50</code> to an image of width 1280 x 720, the new image will have a size of 640 x 360. This is useful to speed up the time of analysis such as those computed with <code>analyze_objects()</code> and <code>measure_disease()</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image_dimension</span>(soy)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ----------------------</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Image dimension</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="do">## ----------------------</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Width :  1281 </span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Height:  910</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>soy_resized <span class="ot">&lt;-</span> <span class="fu">image_resize</span>(soy, <span class="at">rel_size =</span> <span class="dv">50</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">image_dimension</span>(soy_resized)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ----------------------</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Image dimension</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="do">## ----------------------</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Width :  640 </span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Height:  455</span></span></code></pre></div>
</div>
<div id="crop-an-image" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Crop an image</h3>
<p>Cropping images is useful to remove noises from the image edge, as well as to reduce the size of images before processing. To crop an image, the function <code>image_crop()</code> is used. Users need to inform a numeric vector indicating the pixel range (<code>width</code> and <code>height</code>) that will be maintained in the cropped image.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>crop1 <span class="ot">&lt;-</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_crop</span>(soy,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">width =</span> <span class="dv">170</span><span class="sc">:</span><span class="dv">720</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">height =</span> <span class="dv">300</span><span class="sc">:</span><span class="dv">650</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
<p>If only <code>width</code> or <code>height</code> are informed, the image will be cropped vertically or horizontally.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>crop2 <span class="ot">&lt;-</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_crop</span>(soy,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">width =</span> <span class="dv">170</span><span class="sc">:</span><span class="dv">720</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-6-1.png" width="768" /></p>
<p>If both <code>width</code> and <code>height</code> are missing, an iterative process of image cropping is performed.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># only run in an iterative section</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">image_crop</span>(soy)</span></code></pre></div>
<p>Additionally, an automated cropping process can be performed. In this case, the image will be automatically cropped to the area of objects with an edge of five pixels by default.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>auto_crop <span class="ot">&lt;-</span> <span class="fu">image_autocrop</span>(soy, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-8-1.png" width="768" /></p>
<p>The function <code>image_trim()</code> is used to trim pixels from image edges.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># trim 100 pixels from all edges</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>soy_trim <span class="ot">&lt;-</span> <span class="fu">image_trim</span>(soy, <span class="at">edge =</span> <span class="dv">100</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The same is achieved with</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>soy_trim2 <span class="ot">&lt;-</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_trim</span>(soy,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">top =</span> <span class="dv">100</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">bottom =</span> <span class="dv">100</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">left =</span> <span class="dv">100</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">right =</span> <span class="dv">100</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/manipulate2-1.png" width="960" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># trim 200 pixels from top and bottom</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>soy_trim3 <span class="ot">&lt;-</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_trim</span>(soy,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">top =</span> <span class="dv">200</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">bottom =</span> <span class="dv">200</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/manipulate2-2.png" width="960" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># trim to 5 pixels around objects&#39; area</span></span></code></pre></div>
</div>
<div id="dpi" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Image resolution (DPI)</h3>
<p>The function <code>dpi()</code> runs an interactive function to compute the image resolution given a known distance informed by the user. To compute the image resolution (dpi) the user must use the left button mouse to create a line of known distance. This can be done, for example, using a template with known distance in the image (e.g., <code>leaves.JPG</code>).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># only run in an interactive section</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>leaves <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;./data/leaf_area/leaves.JPG&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dpi</span>(leaves)</span></code></pre></div>
<iframe width="760" height="430" src="https://www.youtube.com/embed/Rh10_pLgeng" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</div>
<div id="rotate-an-image" class="section level3" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Rotate an image</h3>
<p><code>image_rotate()</code> is used to rotates the image clockwise by the given angle.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>soy_rotated <span class="ot">&lt;-</span> <span class="fu">image_rotate</span>(soy, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/manipulate3-1.png" width="768" /></p>
</div>
<div id="horizontal-and-vertical-reflection" class="section level3" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> Horizontal and vertical reflection</h3>
<p><code>image_hreflect()</code> and <code>image_vreflect()</code> performs vertical and horizontal reflection of images, respectively.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>soy_hrefl <span class="ot">&lt;-</span> <span class="fu">image_hreflect</span>(soy)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>soy_vrefl <span class="ot">&lt;-</span> <span class="fu">image_vreflect</span>(soy)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(soy, soy_hrefl, soy_vrefl, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/manipulate4-1.png" width="1920" /></p>
</div>
<div id="horizontal-and-vertical-conversion" class="section level3" number="4.3.6">
<h3><span class="header-section-number">4.3.6</span> Horizontal and vertical conversion</h3>
<p><code>image_horizontal()</code> and <code>image_vertical()</code> converts (if needed) an image to a horizontal or vertical image, respectively.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>soy_h <span class="ot">&lt;-</span> <span class="fu">image_horizontal</span>(soy)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>soy_v <span class="ot">&lt;-</span> <span class="fu">image_vertical</span>(soy)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(soy, soy_h, soy_v, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/manipulate5-1.png" width="1920" /></p>
</div>
<div id="filter-blur-contrast-dilatation-and-erosion" class="section level3" number="4.3.7">
<h3><span class="header-section-number">4.3.7</span> Filter, blur, contrast, dilatation, and erosion</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>soy_filter <span class="ot">&lt;-</span> <span class="fu">image_filter</span>(soy)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>soy_blur <span class="ot">&lt;-</span> <span class="fu">image_blur</span>(soy)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>soy_contrast <span class="ot">&lt;-</span> <span class="fu">image_contrast</span>(soy)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>soy_dilatation <span class="ot">&lt;-</span> <span class="fu">image_dilate</span>(soy)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>soy_erosion <span class="ot">&lt;-</span> <span class="fu">image_erode</span>(soy)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(soy, soy_filter, soy_blur, soy_contrast, soy_dilatation, soy_erosion)</span></code></pre></div>
<p><img src="code_files/figure-html/manipulate6-1.png" width="960" /></p>
</div>
<div id="exporting-images" class="section level3" number="4.3.8">
<h3><span class="header-section-number">4.3.8</span> Exporting images</h3>
<p>To export images to the current directory, use the function <code>image_export()</code>. If a list of images is exported, the images will be saved considering the name and extension present in the list. If no extension is present, the images will be saved as <code>*.jpg</code> files.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image_export</span>(soy, <span class="st">&quot;exported.jpg&quot;</span>)</span></code></pre></div>
</div>
<div id="combining-functions" class="section level3" number="4.3.9">
<h3><span class="header-section-number">4.3.9</span> Combining functions</h3>
<p><code>pliman</code> offers the possibility of combining functions with the new R base (4.1) forward pipe operator <code>|&gt;</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">&quot;soy_grains&quot;</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">path =</span> <span class="st">&quot;./data&quot;</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(a)</span></code></pre></div>
<p><img src="code_files/figure-html/combiningfunct-1.png" width="960" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># reduce resolution, autocrop, vertical rotation,</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create a binary image, export</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>a <span class="sc">|&gt;</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_resize</span>(<span class="at">rel_size =</span> <span class="dv">50</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_blur</span>() <span class="sc">|&gt;</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_autocrop</span>() <span class="sc">|&gt;</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_vertical</span>() <span class="sc">|&gt;</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_binary</span>(<span class="at">index =</span> <span class="st">&quot;NB&quot;</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">resize =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_combine</span>()</span></code></pre></div>
<p><img src="code_files/figure-html/combiningfunct-2.png" width="960" /></p>
</div>
</div>
</div>
<div id="image-segmentation" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Image segmentation</h1>
<p>In <code>pliman</code> the following functions can be used to segment an image.</p>
<ul>
<li><code>image_binary()</code> to produce a binary (black and white) image</li>
<li><code>image_segment()</code> to produce a segmented image (image objects and a white background).</li>
<li><code>image_segment_iter()</code> to segment an image iteratively.</li>
</ul>
<p>Both functions segment the image based on the value of some image index, which may be one of the RGB bands or any operation with these bands. Internally, these functions call <code>image_index()</code> to compute these indexes. The following indexes are currently available.</p>
<table>
<thead>
<tr class="header">
<th>Index</th>
<th align="center">Equation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>R</td>
<td align="center">R</td>
</tr>
<tr class="even">
<td>G</td>
<td align="center">G</td>
</tr>
<tr class="odd">
<td>B</td>
<td align="center">B</td>
</tr>
<tr class="even">
<td>NR</td>
<td align="center">R/(R+G+B)</td>
</tr>
<tr class="odd">
<td>NG</td>
<td align="center">G/(R+G+B)</td>
</tr>
<tr class="even">
<td>NB</td>
<td align="center">B/(R+G+B)</td>
</tr>
<tr class="odd">
<td>GB</td>
<td align="center">G/B</td>
</tr>
<tr class="even">
<td>RB</td>
<td align="center">R/B</td>
</tr>
<tr class="odd">
<td>GR</td>
<td align="center">G/R</td>
</tr>
<tr class="even">
<td>BI</td>
<td align="center">sqrt((R^2+G^2+B^2)/3)</td>
</tr>
<tr class="odd">
<td>BIM</td>
<td align="center">sqrt((R*2+G*2+B*2)/3)</td>
</tr>
<tr class="even">
<td>SCI</td>
<td align="center">(R-G)/(R+G)</td>
</tr>
<tr class="odd">
<td>GLI</td>
<td align="center">(2*G-R-B)/(2*G+R+B)</td>
</tr>
<tr class="even">
<td>HI</td>
<td align="center">(2*R-G-B)/(G-B)</td>
</tr>
<tr class="odd">
<td>NGRDI</td>
<td align="center">(G-R)/(G+R)</td>
</tr>
<tr class="even">
<td>NDGBI</td>
<td align="center">(G-B)/(G+B)</td>
</tr>
<tr class="odd">
<td>NDRBI</td>
<td align="center">(R-B)/(R+B)</td>
</tr>
<tr class="even">
<td>I</td>
<td align="center">R+G+B</td>
</tr>
<tr class="odd">
<td>S</td>
<td align="center">((R+G+B)-3*B)/(R+G+B)</td>
</tr>
<tr class="even">
<td>VARI</td>
<td align="center">(G-R)/(G+R-B)</td>
</tr>
<tr class="odd">
<td>HUE</td>
<td align="center">atan(2*(B-G-R)/30.5*(G-R))</td>
</tr>
<tr class="even">
<td>HUE2</td>
<td align="center">atan(2*(R-G-R)/30.5*(G-B))</td>
</tr>
<tr class="odd">
<td>BGI</td>
<td align="center">B/G</td>
</tr>
<tr class="even">
<td>L</td>
<td align="center">R+G+B/3</td>
</tr>
<tr class="odd">
<td>GRAY</td>
<td align="center">0.299*R + 0.587*G + 0.114*B</td>
</tr>
<tr class="even">
<td>GLAI</td>
<td align="center">(25*(G-R)/(G+R-B)+1.25)</td>
</tr>
<tr class="odd">
<td>GRVI</td>
<td align="center">(G-R)/(G+R)</td>
</tr>
<tr class="even">
<td>CI</td>
<td align="center">(R-B)/R</td>
</tr>
<tr class="odd">
<td>SHP</td>
<td align="center">2*(R-G-B)/(G-B)</td>
</tr>
<tr class="even">
<td>RI</td>
<td align="center">R**2/(B*G**3)</td>
</tr>
</tbody>
</table>
<p>Here, I use the argument <code>index"</code> to test the segmentation based on the RGB and their normalized values. Users can also provide their index with the argument <code>my_index</code>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>soy <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;./data/segmentation/seg_medium.jpg&quot;</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/segmentation1-1.png" width="768" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the indexes</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>indexes <span class="ot">&lt;-</span> <span class="fu">image_index</span>(soy, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;R, G, B, NR, NG, NB&quot;</span>))</span></code></pre></div>
<p><img src="code_files/figure-html/segmentation2-1.png" width="960" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a raster plot with the RGB values</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(indexes)</span></code></pre></div>
<p><img src="code_files/figure-html/segmentation2-2.png" width="960" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a density with the RGB values</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(indexes, <span class="at">type =</span> <span class="st">&quot;density&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/segmentation2-3.png" width="960" /></p>
<p>In this example, we can see the distribution of the RGB values (first row) and the normalized RGB values (second row). The two peaks represent the grains (smaller peak) and the blue background (larger peak). The clearer the difference between these peaks, the better will the image segmentation.</p>
<div id="segment-an-image" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Segment an image</h2>
<p>The function <code>image_segmentation()</code> is used to segment images using image indexes. In this example, I will use the same indexes computed below to see how the image is segmented. The output of this function can be used as input in the function <code>analyze_objects()</code>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>segmented <span class="ot">&lt;-</span> <span class="fu">image_segment</span>(soy, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;R, G, B, NR, NG, NB&quot;</span>))</span></code></pre></div>
<p><img src="code_files/figure-html/segmentation3-1.png" width="960" /></p>
<p>It seems that the <code>"NB"</code> index provided better segmentation. <code>"R"</code> and <code>"NR"</code> resulted in an inverted segmented image, i.e., the grains were considered as background and the remaining as ‘selected’ image. To circumvent this problem, we can use the argument <code>invert</code> in those functions.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image_segment</span>(soy,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;R, NR&quot;</span>),</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">invert =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/segmentation4-1.png" width="960" /></p>
</div>
<div id="iterative-segmentation" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Iterative segmentation</h2>
<p>The function <code>image_segment_iter()</code> provides an iterative image segmentation, returning the proportions of segmented pixels. This is useful when more than one segmentation procedure is needed. Users can choose how many segmentation to perform, using the argument <code>nseg</code>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>seg_iter <span class="ot">&lt;-</span> <span class="fu">image_pliman</span>(<span class="st">&quot;sev_leaf_nb.jpg&quot;</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/segmentation5-1.png" width="768" /></p>
<p>Using a soybean sample leaf (above), I will use the function <code>image_segment_iter</code> to segment the diseased tissue from healthy tissue. The aim is to segment the symptoms into two classes, namely, necrosis (brown areas) and chlorosis (yellow areas), and compute the percentage of each symptom class.</p>
<p>First, we need to find a suitable index for segmentation.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First segmentation</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>seg <span class="ot">&lt;-</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_segment</span>(seg_iter,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/segmentation6-1.png" width="960" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># second segmentation</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>seg2 <span class="ot">&lt;-</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_segment</span>(seg<span class="sc">$</span>VARI<span class="sc">$</span>image,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/segmentation6-2.png" width="960" /></p>
<p>Note that the same results can be obtained with <code>image_segment_iter()</code> using an iterative section.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only run iteratively</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">image_segment_iter</span>(seg_iter, <span class="at">nseg =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>The <code>"VARI"</code> seems to be a suitable index to segment symptoms (necrosis and chlorosis) from healthy tissues. The <code>"GLI"</code> can be used to segment necrosis from chlorosis. Knowing this, we can now use <code>image_segment_iter()</code> explicitly indicating these indexes, as follows</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">image_segment_iter</span>(seg_iter,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nseg =</span> <span class="dv">2</span>, <span class="co"># two segmentations</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;VARI&quot;</span>, <span class="st">&quot;GLI&quot;</span>),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="do">##      image  pixels   percent</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 original 1317600 100.00000</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     seg1  399075  30.28802</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     seg2  103464  25.92595</span></span></code></pre></div>
<p><img src="code_files/figure-html/segmentation8-1.png" width="960" /></p>
<p>It can be observed that 30.28% of the original image were characterized as symptoms (both necrosis and chlorosis). Of out this (symptomatic area), 25.92% are necrotic areas. So 7.85% of the total area were considered as necrotic areas (30.288 <span class="math inline">\(\times\)</span> 0.2592 or 103464/1317600 <span class="math inline">\(\times\)</span> 100) and 22.43% (30.28 - 7.85 or (399075 - 103464) / 1317600 <span class="math inline">\(\times\)</span> 100) were considered as chlorotic areas.</p>
<p>Users can use the argument <code>threshold</code> to control how segmentation is made. By default (<code>threshold = "Otsu"</code>), a threshold value based on Otsu’s method is used to reduce the grayscale image to a binary image. If a numeric value is informed, this value will be used as a threshold. Inform any non-numeric value different than <code>"Otsu"</code> to iteratively choose the threshold based on a raster plot showing pixel intensity of the index. For <code>image_segmentation_iter()</code>, a vector (allows a mixed (numeric and character) type) with the same length of <code>nseg</code> can be used.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>seg_iter1 <span class="ot">&lt;-</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_segment_iter</span>(seg_iter,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nseg =</span> <span class="dv">2</span>, <span class="co"># two segmentations</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;VARI&quot;</span>, <span class="st">&quot;GLI&quot;</span>),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">threshold =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="st">&quot;Otsu&quot;</span>),</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="do">##      image  pixels   percent</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 original 1317600 100.00000</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     seg1  195288  14.82149</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     seg2   95151  48.72342</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>seg_iter2 <span class="ot">&lt;-</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_segment_iter</span>(seg_iter,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nseg =</span> <span class="dv">2</span>, <span class="co"># two segmentations</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;VARI&quot;</span>, <span class="st">&quot;GLI&quot;</span>),</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">threshold =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="st">&quot;Otsu&quot;</span>),</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="do">##      image  pixels   percent</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 original 1317600 100.00000</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     seg1  321729  24.41781</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     seg2  101883  31.66733</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(seg_iter1<span class="sc">$</span>images<span class="sc">$</span>seg1,</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>              seg_iter2<span class="sc">$</span>images<span class="sc">$</span>seg1)</span></code></pre></div>
<p><img src="code_files/figure-html/segmentation9-1.png" width="960" /></p>
<p>Users can then set the argument <code>threshold</code> for their specific case, depending on the aims of the segmentation.</p>
</div>
</div>
<div id="producing-a-binary-image" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Producing a binary image</h1>
<p>We can also produce a binary image with <code>image_binary()</code>. Just for curiosity, we will use the indexes <code>"B"</code> (blue) and <code>"NB"</code> (normalized blue). By default, <code>image_binary()</code> rescales the image to 30% of the size of the original image to speed up the computation time. Use the argument <code>resize = FALSE</code> to produce a binary image with the original size.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>binary <span class="ot">&lt;-</span> <span class="fu">image_binary</span>(soy)</span></code></pre></div>
<p><img src="code_files/figure-html/binary1-1.png" width="960" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># original image size</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">image_binary</span>(soy,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;B, NB&quot;</span>),</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">resize =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/binary1-2.png" width="960" /></p>
</div>
<div id="count-objects" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Count objects</h1>
<div id="check-the-better-index-to-segment-the-image" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Check the better index to segment the image</h2>
<ul>
<li>Blue background</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wheat (NB)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>dir_wb <span class="ot">&lt;-</span> <span class="st">&quot;./data/count_objects/images/img_wb_50_1.jpg&quot;</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">image =</span> dir_wb)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">image_binary</span>(wb)</span></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-10-1.png" width="960" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># soybean (NB)</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>dir_sb <span class="ot">&lt;-</span> <span class="st">&quot;./data/count_objects/images/img_sb_50_1.jpg&quot;</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>sb <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">image =</span> dir_sb)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">image_binary</span>(sb)</span></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-10-2.png" width="960" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># bean (NR with invert= TRUE)</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>dir_bb <span class="ot">&lt;-</span> <span class="st">&quot;./data/count_objects/images/img_bb_50_1.jpg&quot;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">image =</span> dir_bb)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">image_binary</span>(bb)</span></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-10-3.png" width="960" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="do">### SOYBEAN</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># mid-resolution images (_50) and with no filtering</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.time</span>(</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    sb_res_50_nf <span class="ot">&lt;-</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;sb_50&quot;</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="co"># mid-resolution images (_50) and with filtering</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.time</span>(</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    sb_res_50_wf <span class="ot">&lt;-</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;sb_50&quot;</span>,</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">filter =</span> <span class="dv">2</span>,</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>                      <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="co"># high-resolution images (_100) and with no filtering</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.time</span>(</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>    sb_res_100_nf <span class="ot">&lt;-</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;sb_100&quot;</span>,</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>                      <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a><span class="co"># low-resolution images (_100) and with filtering</span></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>t4 <span class="ot">&lt;-</span></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.time</span>(</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>    sb_res_100_wf <span class="ot">&lt;-</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;sb_100&quot;</span>,</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>                      <span class="at">filter =</span> <span class="dv">3</span>,</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>                      <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a><span class="do">### WHEAT</span></span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a><span class="co"># mid-resolution images (_50) and with no filtering</span></span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a>wb_res_50_nf <span class="ot">&lt;-</span></span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;wb_50&quot;</span>,</span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a><span class="co"># mid-resolution images (_50) and with filtering</span></span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a>wb_res_50_wf <span class="ot">&lt;-</span></span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;wb_50&quot;</span>,</span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filter =</span> <span class="dv">2</span>,</span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a><span class="co"># high-resolution images (_100) and with no filtering</span></span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a>wb_res_100_nf <span class="ot">&lt;-</span></span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;wb_100&quot;</span>,</span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a><span class="co"># low-resolution images (_100) and with filtering</span></span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a>wb_res_100_wf <span class="ot">&lt;-</span></span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;wb_100&quot;</span>,</span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb45-90"><a href="#cb45-90" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-92"><a href="#cb45-92" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filter =</span> <span class="dv">3</span>,</span>
<span id="cb45-93"><a href="#cb45-93" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-95"><a href="#cb45-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-96"><a href="#cb45-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-97"><a href="#cb45-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-98"><a href="#cb45-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-99"><a href="#cb45-99" aria-hidden="true" tabindex="-1"></a><span class="do">### BEAN</span></span>
<span id="cb45-100"><a href="#cb45-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-101"><a href="#cb45-101" aria-hidden="true" tabindex="-1"></a><span class="co"># mid-resolution images (_50) and with no filtering</span></span>
<span id="cb45-102"><a href="#cb45-102" aria-hidden="true" tabindex="-1"></a>bb_res_50_nf <span class="ot">&lt;-</span></span>
<span id="cb45-103"><a href="#cb45-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;bb_50&quot;</span>,</span>
<span id="cb45-104"><a href="#cb45-104" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb45-105"><a href="#cb45-105" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;NR&quot;</span>,</span>
<span id="cb45-106"><a href="#cb45-106" aria-hidden="true" tabindex="-1"></a>                  <span class="at">invert =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-107"><a href="#cb45-107" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-108"><a href="#cb45-108" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-109"><a href="#cb45-109" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-110"><a href="#cb45-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-111"><a href="#cb45-111" aria-hidden="true" tabindex="-1"></a><span class="co"># mid-resolution images (_50) and with filtering</span></span>
<span id="cb45-112"><a href="#cb45-112" aria-hidden="true" tabindex="-1"></a>bb_res_50_wf <span class="ot">&lt;-</span></span>
<span id="cb45-113"><a href="#cb45-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;bb_50&quot;</span>,</span>
<span id="cb45-114"><a href="#cb45-114" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb45-115"><a href="#cb45-115" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;NR&quot;</span>,</span>
<span id="cb45-116"><a href="#cb45-116" aria-hidden="true" tabindex="-1"></a>                  <span class="at">invert =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-117"><a href="#cb45-117" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-118"><a href="#cb45-118" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-119"><a href="#cb45-119" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filter =</span> <span class="dv">2</span>,</span>
<span id="cb45-120"><a href="#cb45-120" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-121"><a href="#cb45-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-122"><a href="#cb45-122" aria-hidden="true" tabindex="-1"></a><span class="co"># high-resolution images (_100) and with no filtering</span></span>
<span id="cb45-123"><a href="#cb45-123" aria-hidden="true" tabindex="-1"></a>bb_res_100_nf <span class="ot">&lt;-</span></span>
<span id="cb45-124"><a href="#cb45-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;bb_100&quot;</span>,</span>
<span id="cb45-125"><a href="#cb45-125" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb45-126"><a href="#cb45-126" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;NR&quot;</span>,</span>
<span id="cb45-127"><a href="#cb45-127" aria-hidden="true" tabindex="-1"></a>                  <span class="at">invert =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-128"><a href="#cb45-128" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-129"><a href="#cb45-129" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-130"><a href="#cb45-130" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-131"><a href="#cb45-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-132"><a href="#cb45-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-133"><a href="#cb45-133" aria-hidden="true" tabindex="-1"></a><span class="co"># low-resolution images (_100) and with filtering</span></span>
<span id="cb45-134"><a href="#cb45-134" aria-hidden="true" tabindex="-1"></a>bb_res_100_wf <span class="ot">&lt;-</span></span>
<span id="cb45-135"><a href="#cb45-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;bb_100&quot;</span>,</span>
<span id="cb45-136"><a href="#cb45-136" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb45-137"><a href="#cb45-137" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;NR&quot;</span>,</span>
<span id="cb45-138"><a href="#cb45-138" aria-hidden="true" tabindex="-1"></a>                  <span class="at">invert =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-139"><a href="#cb45-139" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-140"><a href="#cb45-140" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-141"><a href="#cb45-141" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filter =</span> <span class="dv">3</span>,</span>
<span id="cb45-142"><a href="#cb45-142" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<ul>
<li>white background</li>
</ul>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># wheat (NB)</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>dir_ww <span class="ot">&lt;-</span> <span class="st">&quot;./data/count_objects/images/img_ww_50_1.jpg&quot;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>ww <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">image =</span> dir_ww)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">image_binary</span>(ww)</span></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-11-1.png" width="960" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># soybean (NB)</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>dir_sw <span class="ot">&lt;-</span> <span class="st">&quot;./data/count_objects/images/img_sw_50_1.jpg&quot;</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>sw <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">image =</span> dir_sw)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">image_binary</span>(sw)</span></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-11-2.png" width="960" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># bean (G)</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>dir_bw <span class="ot">&lt;-</span> <span class="st">&quot;./data/count_objects/images/img_bw_50_1.jpg&quot;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">image =</span> dir_bw)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">image_binary</span>(bw)</span></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-11-3.png" width="960" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">### SOYBEAN</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mid-resolution images (_50) and with no filtering</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>sw_res_50_nf <span class="ot">&lt;-</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;sw_50&quot;</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co"># mid-resolution images (_50) and with filtering</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>sw_res_50_wf <span class="ot">&lt;-</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;sw_50&quot;</span>,</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filter =</span> <span class="dv">2</span>,</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>sw_res_100_nf <span class="ot">&lt;-</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;sw_100&quot;</span>,</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a><span class="co"># low-resolution images (_100) and with filtering</span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>sw_res_100_wf <span class="ot">&lt;-</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;sw_100&quot;</span>,</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filter =</span> <span class="dv">3</span>,</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a><span class="do">### WHEAT</span></span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a><span class="co"># mid-resolution images (_50) and with no filtering</span></span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>ww_res_50_nf <span class="ot">&lt;-</span></span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;ww_50&quot;</span>,</span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a><span class="co"># mid-resolution images (_50) and with filtering</span></span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a>ww_res_50_wf <span class="ot">&lt;-</span></span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;ww_50&quot;</span>,</span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb49-56"><a href="#cb49-56" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-57"><a href="#cb49-57" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filter =</span> <span class="dv">2</span>,</span>
<span id="cb49-58"><a href="#cb49-58" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-59"><a href="#cb49-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-60"><a href="#cb49-60" aria-hidden="true" tabindex="-1"></a><span class="co"># high-resolution images (_100) and with no filtering</span></span>
<span id="cb49-61"><a href="#cb49-61" aria-hidden="true" tabindex="-1"></a>ww_res_100_nf <span class="ot">&lt;-</span></span>
<span id="cb49-62"><a href="#cb49-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;ww_100&quot;</span>,</span>
<span id="cb49-63"><a href="#cb49-63" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb49-64"><a href="#cb49-64" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb49-65"><a href="#cb49-65" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-66"><a href="#cb49-66" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-67"><a href="#cb49-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-68"><a href="#cb49-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-69"><a href="#cb49-69" aria-hidden="true" tabindex="-1"></a><span class="co"># low-resolution images (_100) and with filtering</span></span>
<span id="cb49-70"><a href="#cb49-70" aria-hidden="true" tabindex="-1"></a>ww_res_100_wf <span class="ot">&lt;-</span></span>
<span id="cb49-71"><a href="#cb49-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;ww_100&quot;</span>,</span>
<span id="cb49-72"><a href="#cb49-72" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb49-73"><a href="#cb49-73" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb49-74"><a href="#cb49-74" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-75"><a href="#cb49-75" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filter =</span> <span class="dv">3</span>,</span>
<span id="cb49-76"><a href="#cb49-76" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-77"><a href="#cb49-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-78"><a href="#cb49-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-79"><a href="#cb49-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-80"><a href="#cb49-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-81"><a href="#cb49-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-82"><a href="#cb49-82" aria-hidden="true" tabindex="-1"></a><span class="do">### BEAN</span></span>
<span id="cb49-83"><a href="#cb49-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-84"><a href="#cb49-84" aria-hidden="true" tabindex="-1"></a><span class="co"># mid-resolution images (_50) and with no filtering</span></span>
<span id="cb49-85"><a href="#cb49-85" aria-hidden="true" tabindex="-1"></a>bw_res_50_nf <span class="ot">&lt;-</span></span>
<span id="cb49-86"><a href="#cb49-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;bw_50&quot;</span>,</span>
<span id="cb49-87"><a href="#cb49-87" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb49-88"><a href="#cb49-88" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb49-89"><a href="#cb49-89" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> T,</span>
<span id="cb49-90"><a href="#cb49-90" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> F,</span>
<span id="cb49-91"><a href="#cb49-91" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-92"><a href="#cb49-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-93"><a href="#cb49-93" aria-hidden="true" tabindex="-1"></a><span class="co"># mid-resolution images (_50) and with filtering</span></span>
<span id="cb49-94"><a href="#cb49-94" aria-hidden="true" tabindex="-1"></a>bw_res_50_wf <span class="ot">&lt;-</span></span>
<span id="cb49-95"><a href="#cb49-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;bw_50&quot;</span>,</span>
<span id="cb49-96"><a href="#cb49-96" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb49-97"><a href="#cb49-97" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb49-98"><a href="#cb49-98" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb49-99"><a href="#cb49-99" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-100"><a href="#cb49-100" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filter =</span> <span class="dv">2</span>,</span>
<span id="cb49-101"><a href="#cb49-101" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-102"><a href="#cb49-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-103"><a href="#cb49-103" aria-hidden="true" tabindex="-1"></a><span class="co"># high-resolution images (_100) and with no filtering</span></span>
<span id="cb49-104"><a href="#cb49-104" aria-hidden="true" tabindex="-1"></a>bw_res_100_nf <span class="ot">&lt;-</span></span>
<span id="cb49-105"><a href="#cb49-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;bw_100&quot;</span>,</span>
<span id="cb49-106"><a href="#cb49-106" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb49-107"><a href="#cb49-107" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb49-108"><a href="#cb49-108" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb49-109"><a href="#cb49-109" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-110"><a href="#cb49-110" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-111"><a href="#cb49-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-112"><a href="#cb49-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-113"><a href="#cb49-113" aria-hidden="true" tabindex="-1"></a><span class="co"># low-resolution images (_100) and with filtering</span></span>
<span id="cb49-114"><a href="#cb49-114" aria-hidden="true" tabindex="-1"></a>bw_res_100_wf <span class="ot">&lt;-</span></span>
<span id="cb49-115"><a href="#cb49-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;bw_100&quot;</span>,</span>
<span id="cb49-116"><a href="#cb49-116" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb49-117"><a href="#cb49-117" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb49-118"><a href="#cb49-118" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb49-119"><a href="#cb49-119" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-120"><a href="#cb49-120" aria-hidden="true" tabindex="-1"></a>                  <span class="at">filter =</span> <span class="dv">3</span>,</span>
<span id="cb49-121"><a href="#cb49-121" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="concordance" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Concordance</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>validation <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;data/count_objects/count_data.xlsx&quot;</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="do">### overall concordance</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">get_ccc</span>(validation, real, predicted)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["r"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["pc"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["lwr_ci"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["upr_ci"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["bc"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.9547395","2":"0.9525171","3":"0.9411152","4":"0.9617548","5":"0.9976723"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">### concordance by resolution, filtering, crop, background</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>df_ccc <span class="ot">&lt;-</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  validation <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(filter, resolution, background, crop) <span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_ccc</span>(real, predicted) <span class="sc">%&gt;%</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rho =</span> <span class="fu">paste0</span>(<span class="st">&quot;rho[c]:~&quot;</span>, <span class="fu">round</span>(pc, <span class="dv">3</span>)),</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">bc =</span> <span class="fu">paste0</span>(<span class="st">&quot;C[b]:~&quot;</span>, <span class="fu">round</span>(bc, <span class="dv">3</span>)),</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">r =</span> <span class="fu">paste0</span>(<span class="st">&quot;r:~~~&quot;</span>, <span class="fu">round</span>(r, <span class="dv">3</span>)))</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(validation, <span class="fu">aes</span>(real, predicted))<span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span> , <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(crop)),</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.5</span>,</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.75</span>,</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">stroke =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_nested</span>(filter<span class="sc">*</span>resolution <span class="sc">~</span> background<span class="sc">*</span>crop ) <span class="sc">+</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>rho),</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="dv">5</span>,</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> <span class="dv">135</span>,</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df_ccc,</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Actual number of grains&quot;</span>,</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Predicted number of grains&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_theme</span>() <span class="sc">+</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">160</span>),</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">160</span>, <span class="at">by =</span> <span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">160</span>),</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">160</span>, <span class="at">by =</span> <span class="dv">50</span>))</span></code></pre></div>
<p><img src="code_files/figure-html/count1-1.png" width="960" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;figs/count_objects.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="dv">7</span>)</span></code></pre></div>
</div>
<div id="source-of-errors" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Source of errors</h2>
<p>In the following plot, the quantification of the image <code>img_bw_50_1.jpg</code> (bean with blue background) is shown. When no filtering is used, some pixels within grains are considered as background, overestimating the number of grains when processing the image. The use of <code>filter = 2</code> improved the image binarization, providing an accuracy of 1.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>errors <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;./figs/bean_filter.png&quot;</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/errors-1.png" width="960" /></p>
</div>
<div id="benchmarking" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Benchmarking</h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.time</span>(</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_50&quot;</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.time</span>(</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_50&quot;</span>,</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">filter =</span> <span class="dv">2</span>)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.time</span>(</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span>  </span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_100&quot;</span>,</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>                      <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>t4 <span class="ot">&lt;-</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.time</span>(</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span>  </span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_100&quot;</span>,</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>                      <span class="at">filter =</span> <span class="dv">2</span>,</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>                      <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>t5 <span class="ot">&lt;-</span></span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.time</span>(</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> </span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_50&quot;</span>,</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parallel =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>                      <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>t6 <span class="ot">&lt;-</span></span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.time</span>(</span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> </span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_50&quot;</span>,</span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parallel =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a>                      <span class="at">filter =</span> <span class="dv">2</span>,</span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a>                      <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a>t7 <span class="ot">&lt;-</span></span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.time</span>(</span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> </span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_100&quot;</span>,</span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parallel =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a>                      <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-66"><a href="#cb54-66" aria-hidden="true" tabindex="-1"></a>t8 <span class="ot">&lt;-</span></span>
<span id="cb54-67"><a href="#cb54-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.time</span>(</span>
<span id="cb54-68"><a href="#cb54-68" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> </span>
<span id="cb54-69"><a href="#cb54-69" aria-hidden="true" tabindex="-1"></a>      <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_100&quot;</span>,</span>
<span id="cb54-70"><a href="#cb54-70" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dir_original =</span> <span class="st">&quot;./data/count_objects/images&quot;</span>,</span>
<span id="cb54-71"><a href="#cb54-71" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-72"><a href="#cb54-72" aria-hidden="true" tabindex="-1"></a>                      <span class="at">parallel =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-73"><a href="#cb54-73" aria-hidden="true" tabindex="-1"></a>                      <span class="at">filter =</span> <span class="dv">2</span>,</span>
<span id="cb54-74"><a href="#cb54-74" aria-hidden="true" tabindex="-1"></a>                      <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb54-75"><a href="#cb54-75" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>bench <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;data/count_objects/time.xlsx&quot;</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bench, <span class="fu">aes</span>(filter, avg, <span class="at">fill =</span> strategy)) <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span>  <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>resolution) <span class="sc">+</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>))) <span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(avg, <span class="dv">2</span>)),</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_theme</span>() <span class="sc">+</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Filter&quot;</span>,</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Processing<span class="sc">~</span>time<span class="sc">~</span>(s<span class="sc">~</span>image<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>})))</span></code></pre></div>
<p><img src="code_files/figure-html/benchmarking-1.png" width="960" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;figs/benchmarking.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
</div>
<div id="a-little-bit-more" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> A little bit more</h2>
<div id="cells" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Cells</h3>
<p>In the following two examples, I show some variations in the arguments of <code>analyze_objects()</code> to count cells and pollens.</p>
<p>Source of the image: <a href="https://www.youtube.com/watch?v=8c68qIz_ftw" class="uri">https://www.youtube.com/watch?v=8c68qIz_ftw</a></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>cell <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;./data/segmentation/cell.png&quot;</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">image_index</span>(cell, <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/cell-1.png" width="960" /></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>cell_meas <span class="ot">&lt;-</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(cell,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;L&quot;</span>,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">invert =</span> <span class="cn">TRUE</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_segmentation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">&quot;point&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/cell-2.png" width="960" /></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>cell_meas<span class="sc">$</span>statistics</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["stat"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"n","2":"146.00000"},{"1":"min_area","2":"53.00000"},{"1":"mean_area","2":"189.34247"},{"1":"max_area","2":"477.00000"},{"1":"sd_area","2":"76.74134"},{"1":"sum_area","2":"27644.00000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Source of the image: <a href="https://www.youtube.com/watch?v=PqHFsmS1_JY" class="uri">https://www.youtube.com/watch?v=PqHFsmS1_JY</a></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>cell2 <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;./data/segmentation/cell2.png&quot;</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/cell2-1.png" width="960" /></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image_index</span>(cell2, <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/cell2-2.png" width="960" /></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>ind_bim <span class="ot">&lt;-</span> <span class="fu">image_index</span>(cell2, <span class="st">&quot;BIM&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/cell2-3.png" width="960" /></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ind_bim)</span></code></pre></div>
<p><img src="code_files/figure-html/cell2-4.png" width="960" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># chose the BIM index and 0.6 as threshold value</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>cell2_meas <span class="ot">&lt;-</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(cell2,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;BIM&quot;</span>,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">invert =</span> <span class="cn">TRUE</span>, <span class="co"># invert the segmentation</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">threshold =</span> <span class="fl">0.6</span>,</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/cell2-5.png" width="960" /></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>cell2_meas<span class="sc">$</span>statistics</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["stat"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"n","2":"712.00000"},{"1":"min_area","2":"4.00000"},{"1":"mean_area","2":"35.58146"},{"1":"max_area","2":"164.00000"},{"1":"sd_area","2":"19.72088"},{"1":"sum_area","2":"25334.00000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Source of the image: <a href="https://www.youtube.com/watch?v=PqHFsmS1_JY" class="uri">https://www.youtube.com/watch?v=PqHFsmS1_JY</a></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>cell3 <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;./data/segmentation/cell3.jpg&quot;</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/cell3-1.png" width="960" /></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image_index</span>(cell3, <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/cell3-2.png" width="960" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co"># chose the G index</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>cell3_meas <span class="ot">&lt;-</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(cell3,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;G&quot;</span>,</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">invert =</span> <span class="cn">TRUE</span>, </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_segmentation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/cell3-3.png" width="960" /></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>cell3_meas<span class="sc">$</span>statistics</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["stat"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"n","2":"174.00000"},{"1":"min_area","2":"10.00000"},{"1":"mean_area","2":"49.12644"},{"1":"max_area","2":"85.00000"},{"1":"sd_area","2":"12.54016"},{"1":"sum_area","2":"8548.00000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="pollen" class="section level3" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Pollen</h3>
<p>Source of the image: <a href="https://academic.oup.com/aob/article/104/5/1005/138988" class="uri">https://academic.oup.com/aob/article/104/5/1005/138988</a></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>pollen <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;./data/segmentation/pollen.png&quot;</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/pollen-1.png" width="960" /></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image_index</span>(pollen, <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/pollen-2.png" width="960" /></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>ind_bim <span class="ot">&lt;-</span> <span class="fu">image_index</span>(pollen, <span class="st">&quot;L&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/pollen-3.png" width="960" /></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ind_bim)</span></code></pre></div>
<p><img src="code_files/figure-html/pollen-4.png" width="960" /></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co"># chose the L index</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>pollen_meas <span class="ot">&lt;-</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(pollen,</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;L&quot;</span>,</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">invert =</span> <span class="cn">TRUE</span>, <span class="co"># invert the segmentation</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tolerance =</span> <span class="dv">0</span>,</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/pollen-5.png" width="960" /></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>pollen_meas<span class="sc">$</span>statistics</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["stat"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"n","2":"2401.00000"},{"1":"min_area","2":"9.00000"},{"1":"mean_area","2":"73.64515"},{"1":"max_area","2":"400.00000"},{"1":"sd_area","2":"25.97750"},{"1":"sum_area","2":"176822.00000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="object-features" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Object features</h1>
<p>In the following example, I show how to compute the object contourn, center of mass and the maximum and minimum radius (in pixel units). In this case, the minimum and maximum diameter (computed with <code>analyze_objects()</code>) can be used as a measure to approximate the width and length of the bean grain, respectively.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>bean <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;./data/segmentation/bean.jpg&quot;</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>bean_meas <span class="ot">&lt;-</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(bean,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;HI&quot;</span>,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill_hull =</span> <span class="cn">TRUE</span>,</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_background =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="co"># contour</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> <span class="fu">object_contour</span>(bean,</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">index =</span> <span class="st">&quot;HI&quot;</span>,</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_contour</span>(cont, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a><span class="co"># center of mass</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a><span class="co"># maximum and minimum radius</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">poly_mass</span>(cont)</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_mass</span>(cm,</span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">arrow =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/ofeat-1.png" width="768" /></p>
<p>A second example</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>bean2 <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;./data/segmentation/bean2.jpg&quot;</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>bean2_meas <span class="ot">&lt;-</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(bean2,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;G&quot;</span>,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill_hull =</span> <span class="cn">TRUE</span>,</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_background =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="co"># contour</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> <span class="fu">object_contour</span>(bean2,</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">index =</span> <span class="st">&quot;G&quot;</span>,</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a><span class="co"># smooth the perimeter with fewer vertices (50)</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="fu">poly_spline</span>(cont, <span class="at">vertices =</span> <span class="dv">50</span>)</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_contour</span>(sp, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a><span class="co"># center of mass</span></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">poly_mass</span>(sp)</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_mass</span>(cm,</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">arrow =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/ofeat2-1.png" width="768" /></p>
</div>
<div id="root-length" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Root length</h1>
<p>In the following example, I show how to measure the root length of soybean seedlings. The images were gathered from Silva et al. 2019 <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>roots <span class="ot">&lt;-</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">&quot;root&quot;</span>,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">path =</span> <span class="st">&quot;./data/roots&quot;</span>,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/root-1.png" width="960" /></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> roots[[<span class="dv">1</span>]]</span></code></pre></div>
<p>To measure the root length, first, we will ned to segment the root. Let’s start choosing an index to segment the seedlings from the background</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image_binary</span>(r1, <span class="at">index =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/root1-1.png" width="960" /></p>
<p>The index <code>"B"</code> can be used. To obtain a correct segmentation, the argument <code>invert</code> is used.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>r1_meas <span class="ot">&lt;-</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(r1,</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">invert =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/root2-1.png" width="960" /></p>
<p>Note that the watershed segmentation segmented connected objects into multiple, small objects. We can improve this segmentation using the argument <code>tolerance</code> (a few attempts will be needed to find a suitable value).</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>r1_meas <span class="ot">&lt;-</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(r1,</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">invert =</span> <span class="cn">TRUE</span>,</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tolerance =</span> <span class="fl">3.5</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/root3-1.png" width="960" /></p>
<p>Much better, but yet not what we are looking for. Note that both roots and cotyledons were selected. We can, however, use a constraint in object selection that in this case can be the eccentricity of the object. By using the arguments <code>lower_eccent</code> and <code>upper_eccent</code>, objects can be selected regarding their eccentricity.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>r1_meas<span class="sc">$</span>results[<span class="fu">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;eccentricity&quot;</span>)]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["eccentricity"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"0.8391963","_rn_":"1"},{"1":"2","2":"0.8413775","_rn_":"2"},{"1":"3","2":"0.8402704","_rn_":"3"},{"1":"4","2":"0.8427294","_rn_":"4"},{"1":"5","2":"0.6465342","_rn_":"5"},{"1":"6","2":"0.3241792","_rn_":"6"},{"1":"7","2":"0.9877785","_rn_":"7"},{"1":"8","2":"0.8821435","_rn_":"8"},{"1":"9","2":"0.9954486","_rn_":"9"},{"1":"10","2":"0.9989420","_rn_":"10"},{"1":"11","2":"0.9774940","_rn_":"11"},{"1":"12","2":"0.9867761","_rn_":"12"},{"1":"13","2":"0.9897653","_rn_":"13"},{"1":"14","2":"0.9814292","_rn_":"14"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>It seems that roots have eccentricity higher than 0.95. So, we can select only roots with <code>lower_eccent</code> argument, as follows.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>r1_meas <span class="ot">&lt;-</span> </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(r1,</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">invert =</span> <span class="cn">TRUE</span>,</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tolerance =</span> <span class="dv">3</span>,</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lower_eccent =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/root5-1.png" width="960" /></p>
<p>Now, we have the desired segmentation. Considering that the image resolution is known, the measures can be corrected with <code>get_measures()</code>. For teaching purposes, I will assume a dpi = 150 in this case.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>r1_meas_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(r1_meas, <span class="at">dpi =</span> <span class="dv">150</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>r1_meas_cor</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["x"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["area"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["area_ch"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["perimeter"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["radius_mean"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["radius_min"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["radius_max"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["radius_sd"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["radius_ratio"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["diam_mean"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["diam_min"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["diam_max"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["major_axis"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["minor_axis"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["eccentricity"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["theta"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["solidity"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["circularity"],"name":[20],"type":["dbl"],"align":["right"]}],"data":[{"1":"9","2":"312.009","3":"266.498","4":"1.043","5":"2.398","6":"13.767","7":"1.724","8":"0.036","9":"3.437","10":"57.907","11":"96.163","12":"3.447","13":"0.071","14":"6.874","15":"7.692","16":"0.130","17":"0.999","18":"1.535","19":"0.435","20":"0.069","_rn_":"9"},{"1":"10","2":"450.269","3":"243.773","4":"0.772","5":"1.941","6":"9.991","7":"1.239","8":"0.087","9":"2.472","10":"40.175","11":"28.514","12":"2.478","13":"0.173","14":"4.944","15":"5.459","16":"0.092","17":"0.995","18":"1.508","19":"0.398","20":"0.097","_rn_":"10"},{"1":"11","2":"57.858","3":"330.180","4":"1.537","5":"4.549","6":"21.082","7":"2.644","8":"0.073","9":"5.245","10":"89.428","11":"72.227","12":"5.288","13":"0.145","14":"10.490","15":"11.490","16":"0.195","17":"0.999","18":"-1.520","19":"0.338","20":"0.043","_rn_":"11"},{"1":"12","2":"617.316","3":"260.123","4":"0.758","5":"2.752","6":"9.533","7":"1.228","8":"0.230","9":"2.388","10":"37.410","11":"10.379","12":"2.456","13":"0.460","14":"4.775","15":"5.128","16":"0.087","17":"0.977","18":"-1.508","19":"0.276","20":"0.105","_rn_":"12"},{"1":"13","2":"757.825","3":"270.087","4":"0.759","5":"2.767","6":"9.872","7":"1.271","8":"0.168","9":"2.502","10":"40.545","11":"14.884","12":"2.542","13":"0.336","14":"5.005","15":"5.359","16":"0.091","17":"0.987","18":"-1.563","19":"0.274","20":"0.098","_rn_":"13"},{"1":"14","2":"151.126","3":"277.761","4":"0.956","5":"4.834","6":"13.716","7":"1.738","8":"0.152","9":"3.445","10":"56.376","11":"22.646","12":"3.477","13":"0.304","14":"6.889","15":"7.566","16":"0.128","17":"0.990","18":"1.518","19":"0.198","20":"0.064","_rn_":"14"},{"1":"15","2":"894.448","3":"276.710","4":"0.920","5":"4.793","6":"12.209","7":"1.591","8":"0.219","9":"3.147","10":"49.715","11":"14.394","12":"3.183","13":"0.437","14":"6.295","15":"6.555","16":"0.111","17":"0.981","18":"1.460","19":"0.192","20":"0.078","_rn_":"15"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>In this case, the root length can be estimated by the <code>diam_max</code>, which is the maximum diameter of the object.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r1)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(r1_meas_cor, <span class="at">measure =</span> <span class="st">&quot;diam_max&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/root7-1.png" width="960" /></p>
<p>The second image can be analyzed in the same way.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> roots[[<span class="dv">2</span>]]</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>r2_meas <span class="ot">&lt;-</span> </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(r2,</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lower_eccent =</span> <span class="fl">0.95</span>,</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">invert =</span> <span class="cn">TRUE</span>,</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tolerance =</span> <span class="fl">3.5</span>)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>r2_meas_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(r2_meas, <span class="at">dpi =</span> <span class="dv">150</span>)</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(r2_meas_cor, <span class="at">measure =</span> <span class="st">&quot;diam_max&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/root8-1.png" width="960" /></p>
</div>
<div id="leaf-area" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Leaf area</h1>
<p>We can use <code>analyze_objects()</code> to compute object features such as area, perimeter, radius, etc. This can be used, for example, to compute leaf area.
Let’s compute the leaf area of <code>leaves</code> with <code>analyze_objects()</code>. First, we use <code>image_segmentation()</code> to identify candidate indexes to segment foreground (leaves) from background.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>leaves <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;./data/leaf_area/leaves2.JPG&quot;</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/leaf3-1.png" width="960" /></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image_segment</span>(leaves, <span class="at">index =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/leaf4-1.png" width="768" /></p>
<p><code>G</code> (Green) and <code>NB</code> (Normalized Blue) are two possible candidates to segment the leaves from the background. We will use the <code>NB</code> index here (default option in <code>analyze_objects()</code>). The measurement of the leaf area in this approach can be done in two main ways: 1) using an object of known area, and 2) knowing the image resolution in dpi (dots per inch).</p>
<div id="objectsize" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Using an object of known area</h2>
<ul>
<li>Count the number of objects (leaves in this case)</li>
</ul>
<p>Here, we use the argument <code>marker = "id"</code> of the function <code>analyze_objects()</code> to obtain the identification of each object (leaf), allowing for further adjustment of the leaf area.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span> <span class="fu">analyze_objects</span>(leaves, <span class="at">marker =</span> <span class="st">&quot;id&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/leaf5-1.png" width="960" /></p>
<p>Note that “holes” in some leaves resulted in the segmentation of one leaf in more than one object (e.g., 5, 8, 22, 25, 18, 28). This will not affect the total leaf area, but the area of individual leaves and the average leaf area. This can be solved by either setting the argument <code>fill_hull = TRUE</code> or <code>watershed = FALSE</code> (To don’t implement the watershed-based object segmentation). Let’s see how much better we can go.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(leaves,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill_hull =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/leaf6-1.png" width="960" /></p>
<p>Almost there! Due to the morphology of the leaf composed by objects 2 and 23, it was segmented into two objects. This can be solved by setting the argument <code>object_size = "large"</code> that will change the default (medium) values for <code>tolerance</code> and <code>extension</code> arguments.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(leaves,</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill_hull =</span> <span class="cn">TRUE</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">object_size =</span> <span class="st">&quot;large&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/leaf7-1.png" width="960" /></p>
<p>When the objects are not touching each other, the argument <code>watershed = FALSE</code> would be a better option.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_objects</span>(leaves,</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/leaf8-1.png" width="960" /></p>
<p>And here we are! Now, all leaves were identified correctly, but all measures were given in pixel units. The next step is to convert these measures to metric units.</p>
<ul>
<li>Convert the leaf area by the area of the known object</li>
</ul>
<p>The function <code>get_measures()</code> is used to adjust the leaf area using object 10, a square with a side of 5 cm (25 cm<span class="math inline">\(^2\)</span>).</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>area <span class="ot">&lt;-</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_measures</span>(count,</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">id =</span> <span class="dv">10</span>,</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>               area <span class="sc">~</span> <span class="dv">25</span>)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="do">## -----------------------------------------</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="do">## measures corrected with:</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="do">## object id: 10</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="do">## area     : 25</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="do">## -----------------------------------------</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Total    : 822.014 </span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Average  : 35.74 </span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="do">## -----------------------------------------</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>area</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["x"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["area"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["area_ch"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["perimeter"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["radius_mean"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["radius_min"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["radius_max"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["radius_sd"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["radius_ratio"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["diam_mean"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["diam_min"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["diam_max"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["major_axis"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["minor_axis"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["eccentricity"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["theta"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["solidity"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["circularity"],"name":[20],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"276.129","3":"221.430","4":"117.823","5":"118.100","6":"38.381","7":"6.256","8":"4.469","9":"9.246","10":"27.138","11":"2.069","12":"12.513","13":"8.938","14":"18.492","15":"16.615","16":"0.835","17":"0.837","18":"1.529","19":"0.998","20":"1.005","_rn_":"1"},{"1":"2","2":"912.046","3":"191.121","4":"112.962","5":"143.620","6":"55.562","7":"5.959","8":"3.425","9":"8.575","10":"20.758","11":"2.504","12":"11.919","13":"6.849","14":"17.150","15":"13.672","16":"0.687","17":"0.548","18":"-1.558","19":"0.787","20":"0.460","_rn_":"2"},{"1":"3","2":"117.277","3":"501.002","4":"94.569","5":"100.538","6":"46.218","7":"6.267","8":"2.653","9":"10.691","10":"46.500","11":"4.030","12":"12.534","13":"5.306","14":"21.383","15":"18.979","16":"0.953","17":"0.936","18":"-1.510","19":"0.941","20":"0.556","_rn_":"3"},{"1":"4","2":"533.671","3":"164.067","4":"57.425","5":"58.129","6":"27.078","7":"4.360","8":"3.140","9":"6.364","10":"16.271","11":"2.027","12":"8.719","13":"6.280","14":"12.728","15":"10.962","16":"0.551","17":"0.788","18":"-1.487","19":"0.988","20":"0.984","_rn_":"4"},{"1":"5","2":"690.167","3":"172.731","4":"52.138","5":"54.020","6":"26.475","7":"4.231","8":"3.103","9":"6.413","10":"16.586","11":"2.066","12":"8.461","13":"6.207","14":"12.825","15":"10.207","16":"0.513","17":"0.760","18":"-1.392","19":"0.965","20":"0.935","_rn_":"5"},{"1":"6","2":"224.914","3":"751.209","4":"50.626","5":"53.551","6":"25.872","7":"4.051","8":"2.918","9":"5.930","10":"11.935","11":"2.032","12":"8.101","13":"5.836","14":"11.859","15":"9.086","16":"0.456","17":"0.572","18":"-1.471","19":"0.945","20":"0.950","_rn_":"6"},{"1":"7","2":"1047.062","3":"424.418","4":"61.884","5":"62.790","6":"28.987","7":"4.626","8":"2.986","9":"7.148","10":"23.705","11":"2.394","12":"9.252","13":"5.972","14":"14.296","15":"12.675","16":"0.637","17":"0.868","18":"1.404","19":"0.986","20":"0.926","_rn_":"7"},{"1":"8","2":"865.070","3":"761.262","4":"39.607","5":"40.831","6":"23.159","7":"3.664","8":"2.631","9":"5.519","10":"14.081","11":"2.097","12":"7.327","13":"5.263","14":"11.037","15":"8.835","16":"0.444","17":"0.740","18":"-1.329","19":"0.970","20":"0.928","_rn_":"8"},{"1":"9","2":"871.498","3":"486.609","4":"37.911","5":"40.834","6":"23.963","7":"3.574","8":"2.419","9":"5.417","10":"14.594","11":"2.239","12":"7.149","13":"4.839","14":"10.834","15":"8.419","16":"0.423","17":"0.633","18":"-1.476","19":"0.928","20":"0.830","_rn_":"9"},{"1":"10","2":"605.991","3":"664.123","4":"25.000","5":"24.876","6":"19.592","7":"2.835","8":"2.411","9":"3.475","10":"6.134","11":"1.441","12":"5.669","13":"4.822","14":"6.950","15":"5.869","16":"0.295","17":"0.254","18":"-1.563","19":"1.005","20":"0.818","_rn_":"10"},{"1":"11","2":"967.756","3":"628.918","4":"30.204","5":"30.613","6":"19.341","7":"3.189","8":"2.378","9":"4.727","10":"13.566","11":"1.988","12":"6.377","13":"4.756","14":"9.454","15":"8.160","16":"0.410","17":"0.812","18":"1.568","19":"0.987","20":"1.015","_rn_":"11"},{"1":"12","2":"597.344","3":"378.935","4":"28.379","5":"32.082","6":"21.752","7":"3.144","8":"1.962","9":"4.982","10":"15.198","11":"2.539","12":"6.287","13":"3.924","14":"9.963","15":"7.543","16":"0.379","17":"0.635","18":"-1.417","19":"0.885","20":"0.754","_rn_":"12"},{"1":"13","2":"503.668","3":"584.456","4":"25.792","5":"27.186","6":"22.707","7":"3.447","8":"1.585","9":"5.942","10":"26.280","11":"3.748","12":"6.894","13":"3.171","14":"11.885","15":"9.993","16":"0.502","17":"0.939","18":"-1.103","19":"0.949","20":"0.629","_rn_":"13"},{"1":"14","2":"385.436","3":"423.892","4":"20.684","5":"21.997","6":"20.346","7":"2.974","8":"1.402","9":"5.099","10":"22.338","11":"3.636","12":"5.949","13":"2.805","14":"10.197","15":"8.773","16":"0.441","17":"0.934","18":"-1.382","19":"0.940","20":"0.628","_rn_":"14"},{"1":"15","2":"423.393","3":"176.371","4":"15.518","5":"16.028","6":"16.578","7":"2.455","8":"1.170","9":"4.095","10":"16.808","11":"3.500","12":"4.909","13":"2.340","14":"8.190","15":"7.356","16":"0.370","17":"0.926","18":"1.554","19":"0.968","20":"0.710","_rn_":"15"},{"1":"16","2":"847.125","3":"626.891","4":"10.441","5":"10.837","6":"12.258","7":"1.924","8":"1.256","9":"3.026","10":"10.113","11":"2.409","12":"3.849","13":"2.512","14":"6.051","15":"5.006","16":"0.251","17":"0.842","18":"0.235","19":"0.963","20":"0.873","_rn_":"16"},{"1":"17","2":"712.599","3":"457.976","4":"9.118","5":"9.131","6":"13.463","7":"1.950","8":"0.777","9":"3.415","10":"14.864","11":"4.394","12":"3.901","13":"1.555","14":"6.831","15":"6.087","16":"0.306","17":"0.945","18":"1.424","19":"0.999","20":"0.632","_rn_":"17"},{"1":"18","2":"353.365","3":"740.398","4":"5.830","5":"6.231","6":"9.897","7":"1.533","8":"0.872","9":"2.624","10":"9.952","11":"3.009","12":"3.066","13":"1.744","14":"5.247","15":"4.024","16":"0.202","17":"0.878","18":"-0.519","19":"0.936","20":"0.748","_rn_":"18"},{"1":"19","2":"641.395","3":"535.291","4":"4.603","5":"4.505","6":"7.485","7":"1.213","8":"0.839","9":"1.754","10":"5.726","11":"2.089","12":"2.426","13":"1.679","14":"3.507","15":"3.384","16":"0.170","17":"0.859","18":"-1.546","19":"1.022","20":"1.032","_rn_":"19"},{"1":"20","2":"738.920","3":"711.817","4":"8.089","5":"8.646","6":"15.171","7":"1.900","8":"0.492","9":"3.533","10":"16.478","11":"7.179","12":"3.801","13":"0.984","14":"7.066","15":"6.118","16":"0.307","17":"0.955","18":"1.557","19":"0.935","20":"0.442","_rn_":"20"},{"1":"21","2":"344.537","3":"602.703","4":"5.370","5":"5.946","6":"11.806","7":"1.621","8":"0.344","9":"2.997","10":"14.938","11":"8.712","12":"3.243","13":"0.688","14":"5.994","15":"5.516","16":"0.277","17":"0.969","18":"-1.429","19":"0.903","20":"0.484","_rn_":"21"},{"1":"22","2":"714.360","3":"576.056","4":"3.788","5":"3.690","6":"7.134","7":"1.120","8":"0.645","9":"1.719","10":"6.426","11":"2.666","12":"2.240","13":"1.290","14":"3.439","15":"3.312","16":"0.166","17":"0.896","18":"1.421","19":"1.027","20":"0.935","_rn_":"22"},{"1":"23","2":"473.760","3":"785.686","4":"4.252","5":"4.661","6":"27.781","7":"3.482","8":"0.137","9":"6.947","10":"39.753","11":"50.583","12":"6.965","13":"0.275","14":"13.895","15":"14.308","16":"0.719","17":"1.000","18":"-0.037","19":"0.912","20":"0.069","_rn_":"23"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the area to the segmented image</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">image_segment</span>(leaves, <span class="at">index =</span> <span class="st">&quot;NB&quot;</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(area,</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure =</span> <span class="st">&quot;area&quot;</span>,</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="co"># default is &quot;white&quot;</span></span></code></pre></div>
<p><img src="code_files/figure-html/leaf9-1.png" width="960" /></p>
</div>
<div id="knowing-the-image-resolution-in-dpi-dots-per-inch" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> knowing the image resolution in dpi (dots per inch)</h2>
<p>When the image resolution is known, the measures in pixels obtained with <code>analyze_objects()</code> are corrected by the image resolution. The function <code>dpi()</code> can be used to compute the dpi of an image, provided that the size of any object is known. See the <a href="#dpi">dpi</a> section for more details. In this case, the estimated resolution considering the calibration of object 10 was ~50.8 DPIs. We inform this value in the <code>dpi</code> argument of <code>get_measures9)</code>.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>area2 <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(count, <span class="at">dpi =</span> <span class="fl">50.8</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the difference between the two methods</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(area<span class="sc">$</span>area <span class="sc">-</span> area2<span class="sc">$</span>area)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 7.724</span></span></code></pre></div>
</div>
<div id="comparing-pliman-and-leafarea" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Comparing <code>pliman</code> and <code>LeafArea</code></h2>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the exact distance of 826 pixels at 100 dpi</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>kd <span class="ot">&lt;-</span> <span class="fu">pixels_to_cm</span>(<span class="dv">826</span>, <span class="dv">100</span>)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>kd</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co"># change according to your PC</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>directory <span class="ot">&lt;-</span> <span class="st">&quot;E:/Desktop/paper_pliman/data/leaf_area/imagej&quot;</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>path_imgj <span class="ot">&lt;-</span> <span class="st">&quot;C:/Program Files/ImageJ&quot;</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  lfa <span class="ot">&lt;-</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">run.ij</span>(<span class="at">path.imagej =</span> path_imgj,</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">set.directory =</span> directory,</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">known.distance =</span> <span class="fl">20.9804</span>, <span class="co"># run.ig has 21 as default.</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">save.image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">trim.pixel =</span> <span class="dv">0</span>)</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a><span class="co"># total time: ~10.9 s</span></span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  plm <span class="ot">&lt;-</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;img&quot;</span>,    <span class="co"># name pattern</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dir_original =</span> <span class="st">&quot;./data/leaf_area/imagej&quot;</span>,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,        <span class="co"># index to segment leaf and background</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">watershed =</span> <span class="cn">FALSE</span>,  <span class="co"># don&#39;t use watershed segmentation</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">show_image =</span> <span class="cn">FALSE</span>, <span class="co"># don&#39;t show image after processing</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">parallel =</span> <span class="cn">TRUE</span>,    <span class="co"># multiple sections</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="do">##   usuário   sistema decorrido </span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="do">##      0.18      0.05      6.32</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust the measures considering 100 dpi (the same as LeafArea)</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>area <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(plm, <span class="at">dpi =</span> <span class="dv">100</span>)</span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>df_area <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;./data/leaf_area/leaf_area.xlsx&quot;</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>hlt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;img90&quot;</span>, <span class="st">&quot;img87&quot;</span>, <span class="st">&quot;img107&quot;</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>df_area <span class="ot">&lt;-</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  df_area <span class="sc">%&gt;%</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">res =</span> pliman <span class="sc">-</span> leaf_area,</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">ifelse</span>(sample <span class="sc">%in%</span> hlt, sample, <span class="cn">NA</span>))</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the Lin&#39;s concordance correlation</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>df_cor <span class="ot">&lt;-</span> df_area[<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>,]</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>ccc <span class="ot">&lt;-</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>  df_cor <span class="sc">%&gt;%</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(background) <span class="sc">%&gt;%</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_ccc</span>(leaf_area, pliman) <span class="sc">%&gt;%</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rho =</span> <span class="fu">paste0</span>(<span class="st">&quot;rho[c]:~&quot;</span>, <span class="fu">round</span>(pc, <span class="dv">4</span>),</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;[(&quot;</span>,<span class="fu">round</span>(lwr_ci,<span class="dv">4</span>), <span class="st">&quot;-&quot;</span>,</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">round</span>(upr_ci,<span class="dv">4</span>), <span class="st">&quot;)]&quot;</span> ))</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a><span class="co"># create the plot</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_area, <span class="fu">aes</span>(leaf_area, pliman)) <span class="sc">+</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>,</span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> background),</span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">25</span>,</span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">stroke =</span> <span class="fl">0.05</span>,</span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> <span class="fu">subset</span>(df_area, sample <span class="sc">%in%</span> hlt)) <span class="sc">+</span></span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> background),</span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">stroke =</span> <span class="fl">0.05</span>,</span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> <span class="fu">subset</span>(df_area, <span class="sc">!</span>sample <span class="sc">%in%</span> hlt)) <span class="sc">+</span></span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>rho, <span class="at">color =</span> background),</span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>),</span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">240</span>, <span class="dv">260</span>),</span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> ccc,</span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a>            <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb99-45"><a href="#cb99-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">275</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">275</span>, <span class="at">by =</span> <span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb99-46"><a href="#cb99-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">275</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">275</span>, <span class="at">by =</span> <span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb99-47"><a href="#cb99-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;LeafArea&quot;</span>,</span>
<span id="cb99-48"><a href="#cb99-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;pliman&quot;</span>) <span class="sc">+</span></span>
<span id="cb99-49"><a href="#cb99-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_theme</span>() <span class="sc">+</span></span>
<span id="cb99-50"><a href="#cb99-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span>
<span id="cb99-51"><a href="#cb99-51" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Removed 16 rows containing missing values (geom_point).</span></span>
<span id="cb99-52"><a href="#cb99-52" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Removed 163 rows containing missing values (geom_text_repel).</span></span></code></pre></div>
<p><img src="code_files/figure-html/leaf13-1.png" width="960" /></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;figs/pliman_leafarea.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Removed 16 rows containing missing values (geom_point).</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: Removed 163 rows containing missing values (geom_text_repel).</span></span></code></pre></div>
</div>
<div id="variations-in-the-arguments-of-analyze_objects" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Variations in the arguments of <code>analyze_objects()</code></h2>
<p>Here, I show how to produce the masks shown in Figure 8 of the article, using the image <code>img90</code> as an example. The masks are saved into a temporary directory (<code>dir_processed = tempdir()</code>) and combined later.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>img90 <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;img90.jpg&quot;</span>,</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">path =</span> <span class="st">&quot;./data/leaf_area/imagej&quot;</span>,</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/masks-1.png" width="960" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pliman 1</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_objects</span>(img90,</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">save_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">prefix =</span> <span class="st">&quot;proc1_&quot;</span>,</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">dir_processed =</span> <span class="fu">tempdir</span>(),</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,          <span class="co"># index to segment leaf and background</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill_hull =</span> <span class="cn">TRUE</span>,     <span class="co"># fill the injuried area</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_original =</span> <span class="cn">FALSE</span>)<span class="co"># create a mask (not original image)</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a><span class="co"># pliman 2</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_objects</span>(img90,</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">save_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">prefix =</span> <span class="st">&quot;proc2_&quot;</span>,</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">dir_processed =</span> <span class="fu">tempdir</span>(),</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,          <span class="co"># index to segment leaf and background</span></span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill_hull =</span> <span class="cn">FALSE</span>,    <span class="co"># don&#39;t fill the injuried area (default)</span></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_original =</span> <span class="cn">FALSE</span>)<span class="co"># create a mask (not original image)</span></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a><span class="co"># pliman 3</span></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_objects</span>(img90,</span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">save_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">prefix =</span> <span class="st">&quot;proc3_&quot;</span>,</span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">dir_processed =</span> <span class="fu">tempdir</span>(),</span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,             <span class="co"># index to segment leaf and background</span></span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill_hull =</span> <span class="cn">FALSE</span>,       <span class="co"># don&#39;t fill the injuried area (default)</span></span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_contour =</span> <span class="cn">FALSE</span>,    <span class="co"># don&#39;t show object contour</span></span>
<span id="cb102-31"><a href="#cb102-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_original =</span> <span class="cn">TRUE</span>,    <span class="co"># show original object</span></span>
<span id="cb102-32"><a href="#cb102-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">col_background =</span> <span class="st">&quot;black&quot;</span>)<span class="co"># black background</span></span>
<span id="cb102-33"><a href="#cb102-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-34"><a href="#cb102-34" aria-hidden="true" tabindex="-1"></a><span class="co"># pliman 4</span></span>
<span id="cb102-35"><a href="#cb102-35" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_objects</span>(img90,</span>
<span id="cb102-36"><a href="#cb102-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">save_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb102-37"><a href="#cb102-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb102-38"><a href="#cb102-38" aria-hidden="true" tabindex="-1"></a>                <span class="at">prefix =</span> <span class="st">&quot;proc4_&quot;</span>,</span>
<span id="cb102-39"><a href="#cb102-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">dir_processed =</span> <span class="fu">tempdir</span>(),</span>
<span id="cb102-40"><a href="#cb102-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,             <span class="co"># index to segment leaf and background</span></span>
<span id="cb102-41"><a href="#cb102-41" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill_hull =</span> <span class="cn">FALSE</span>,       <span class="co"># don&#39;t fill the injuried area (default)</span></span>
<span id="cb102-42"><a href="#cb102-42" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_original =</span> <span class="cn">FALSE</span>,   <span class="co"># show original object</span></span>
<span id="cb102-43"><a href="#cb102-43" aria-hidden="true" tabindex="-1"></a>                <span class="at">col_background =</span> <span class="st">&quot;black&quot;</span>,<span class="co"># black background</span></span>
<span id="cb102-44"><a href="#cb102-44" aria-hidden="true" tabindex="-1"></a>                <span class="at">col_foreground =</span> <span class="st">&quot;green&quot;</span>)<span class="co"># green foreground</span></span>
<span id="cb102-45"><a href="#cb102-45" aria-hidden="true" tabindex="-1"></a>variations <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">&quot;proc&quot;</span>, <span class="at">path =</span> <span class="fu">tempdir</span>())</span>
<span id="cb102-46"><a href="#cb102-46" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(variations, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/masks-2.png" width="960" /></p>
</div>
</div>
<div id="leaf-shape" class="section level1" number="11">
<h1><span class="header-section-number">11</span> Leaf shape</h1>
<p>The function <code>analyze_objects()</code> computes a range of object features that can be used to study leaf shape. As a motivating example, I will use the image <code>potato_leaves.png</code>, which was gathered from Gupta et al. (2020)<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>potato <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;data/leaf_area/potato_leaves.png&quot;</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>pot_meas <span class="ot">&lt;-</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(potato,</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_chull =</span> <span class="cn">TRUE</span>) <span class="co"># shows the convex hull</span></span></code></pre></div>
<p><img src="code_files/figure-html/potato-1.png" width="960" /></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>pot_meas<span class="sc">$</span>results</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["x"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["area"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["area_ch"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["perimeter"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["radius_mean"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["radius_min"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["radius_max"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["radius_sd"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["radius_ratio"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["diam_mean"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["diam_min"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["diam_max"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["major_axis"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["minor_axis"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["eccentricity"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["theta"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["solidity"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["circularity"],"name":[20],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"854.5021","3":"223.9845","4":"51409","5":"54604","6":"864","7":"131.6104","8":"92.00580","9":"198.8997","10":"26.27966","11":"2.161817","12":"263.2208","13":"184.01159","14":"397.7993","15":"305.8835","16":"242.3054","17":"0.6103275","18":"1.39474531","19":"0.9414878","20":"0.8654093","_rn_":"1"},{"1":"2","2":"197.7975","3":"217.9751","4":"58849","5":"76661","6":"1088","7":"140.1460","8":"70.14579","9":"191.2485","10":"28.62491","11":"2.726444","12":"280.2921","13":"140.29158","14":"382.4971","15":"318.2787","16":"273.8668","17":"0.5095139","18":"-0.09807888","19":"0.7676524","20":"0.6247283","_rn_":"2"},{"1":"3","2":"536.2565","3":"240.1453","4":"35203","5":"63154","6":"1323","7":"109.9245","8":"38.04980","9":"188.6634","10":"35.58658","11":"4.958329","12":"219.8489","13":"76.09961","14":"377.3269","15":"253.9835","16":"243.5813","17":"0.2832585","18":"1.09847274","19":"0.5574152","20":"0.2527376","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Three key measures (in pixel units) are:</p>
<ol style="list-style-type: decimal">
<li><code>area</code> is the area of the object.</li>
<li><code>area_ch</code> is the area of the convex hull.</li>
<li><code>perimeter</code> is the perimeter of the object.</li>
</ol>
<p>Using these measures, circularity and solidity are computed as shown in (Gupta et al, 2020).</p>
<p><span class="math display">\[ circularity = 4\pi(area / perimeter^2)\]</span></p>
<p><span class="math display">\[solidity = area / area\_ch\]</span></p>
<p><span class="math display">\[\sqrt{1-a^2/b^2}\]</span></p>
<p>Circularity is influenced by serrations and lobing. Solidity is sensitive to leaves with deep lobes, or with a distinct petiole, and can be used to distinguish leaves lacking such structures. Unlike circularity, it is not very sensitive to serrations and minor lobings, since the convex hull remains largely unaffected.</p>
<div id="object-contour" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Object contour</h2>
<p>Users can also obtain the object contour and convex hull as follows:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_contour</span>(potato,</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(potato)</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_contour</span>(cont, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/cont-1.png" width="960" /></p>
</div>
<div id="convex-hull" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Convex hull</h2>
<p>The function <code>object_contour()</code> returns a list with the coordinate points for each object contour that can be further used to obtain the convex hull with <code>conv_hull()</code>.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>conv <span class="ot">&lt;-</span> <span class="fu">conv_hull</span>(cont)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(potato)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_contour</span>(conv, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/conv-1.png" width="960" /></p>
</div>
<div id="area-of-the-convex-hull" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Area of the convex hull</h2>
<p>Then, the area of the convex hull can be obtained with <code>poly_area()</code>.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>(area <span class="ot">&lt;-</span> <span class="fu">poly_area</span>(conv))</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="do">## $`1`</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 54604</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="do">## $`2`</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 76661.5</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="do">## $`3`</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 63154</span></span></code></pre></div>
</div>
<div id="leaves-as-ggplot2-plot" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> Leaves as <code>ggplot2</code> plot</h2>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data frame for contour and convex hull</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>df_cont <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cont, <span class="at">.id =</span> <span class="st">&quot;object&quot;</span>)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>df_conv <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(conv, <span class="at">.id =</span> <span class="st">&quot;object&quot;</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a plot</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_cont, <span class="fu">aes</span>(X1, X2, <span class="at">group =</span> object)) <span class="sc">+</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="fu">aes</span>(<span class="at">fill =</span> object)) <span class="sc">+</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> df_conv,</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(x, y, <span class="at">fill =</span> object),</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/maskpoly-1.png" width="960" /></p>
</div>
</div>
<div id="simple-and-compound-leaves" class="section level1" number="12">
<h1><span class="header-section-number">12</span> Simple and compound leaves</h1>
<p>A simple leaf blade is undivided. The blade of a compound leaf is divided into several leaflets. In the following examples, I will show how to analyze simple and compound leaves with <code>analyze_objects()</code>, mainly if the goal is to obtain the measures for each leaf (e.g., mean area), where the number of objects (leaves) will influence the results.</p>
<p>The following images by <a href="https://www.florestaombrofilamista.com.br/sidol/?menu=contact">Daniel Saueressig</a> were obtained from the <a href="https://www.florestaombrofilamista.com.br/sidol/?menu=glossary">“<em>Sistema de Identificação Dendrológica Online - Floresta Ombrófila Mista</em>”</a> and show examples of simple and compound leaves.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>imgs <span class="ot">&lt;-</span> </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_import</span>(<span class="fu">c</span>(<span class="st">&quot;simple.jpg&quot;</span>, <span class="st">&quot;compound.jpg&quot;</span>),</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">path =</span> <span class="st">&quot;./data/leaf_area&quot;</span>,</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/sc1-1.png" width="960" /></p>
<div id="simple-leaves" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> Simple leaves</h2>
<p>Analyzing non-touching simple leaves is fairly simple. We already saw that the normalized blue index provides satisfactory object segmentation using images with a blue background like in this case. So, the default option (<code>index = "NB"</code>) is used. The squares in the background have 4 cm<span class="math inline">\(^2\)</span>. With this information, it is possible to obtain the image resolution with <code>dpi(simple)</code>, which will be useful to adjust the measures. In this case, the estimated dpi is 48.65.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>simple <span class="ot">&lt;-</span> imgs<span class="sc">$</span>simple.jpg</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>sarea <span class="ot">&lt;-</span> <span class="fu">analyze_objects</span>(simple, <span class="at">marker =</span> <span class="st">&quot;id&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/sc2-1.png" width="768" /></p>
<p>Note that with the default settings, the simple leaf was partitioned into small, segmented leaves. As shown in <a href="#objectsize">section 8.1</a> this can be solved by either using <code>object_size = "large"</code> or <code>watershed = FALSE</code>, to omit the watershed segmentation algorithm. The last is used here.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>sarea <span class="ot">&lt;-</span> </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(simple,</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_chull =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/sc3-1.png" width="768" /></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>sarea_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(sarea, <span class="at">dpi =</span> <span class="fl">48.65</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>sarea_cor</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["x"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["area"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["area_ch"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["perimeter"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["radius_mean"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["radius_min"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["radius_max"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["radius_sd"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["radius_ratio"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["diam_mean"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["diam_min"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["diam_max"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["major_axis"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["minor_axis"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["eccentricity"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["theta"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["solidity"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["circularity"],"name":[20],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"184.644","3":"156.252","4":"41.318","5":"55.705","6":"36.077","7":"4.276","8":"1.086","9":"7.970","10":"34.310","11":"7.341","12":"8.553","13":"2.172","14":"15.941","15":"13.642","16":"0.712","17":"0.951","18":"1.490","19":"0.742","20":"0.399","_rn_":"1"},{"1":"2","2":"68.644","3":"151.805","4":"19.926","5":"31.421","6":"27.462","7":"3.011","8":"1.091","9":"5.733","10":"23.037","11":"5.253","12":"6.021","13":"2.183","14":"11.466","15":"9.206","16":"0.481","17":"0.939","18":"1.552","19":"0.634","20":"0.332","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="compound-leaves" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Compound leaves</h2>
<p>For compound leaves, if the watershed segmentation is used, leaflets will probably be considered as different leaves, as can be seen below.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>compound <span class="ot">&lt;-</span> imgs<span class="sc">$</span>compound.jpg</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>carea <span class="ot">&lt;-</span> </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(compound,</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_segmentation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">&quot;id&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/sc4-1.png" width="768" /></p>
<p>Therefore, using <code>watershed = FALSE</code> will solve this problem, since all leaflets connected by at least one pixel will be considered part of the same leaf.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>carea <span class="ot">&lt;-</span> </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(compound,</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_segmentation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_chull =</span> <span class="cn">TRUE</span>,</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">&quot;id&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/sc5-1.png" width="768" /></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>carea_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(carea, <span class="at">dpi =</span> <span class="fl">49.5</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>carea_cor</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["x"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["area"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["area_ch"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["perimeter"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["radius_mean"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["radius_min"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["radius_max"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["radius_sd"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["radius_ratio"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["diam_mean"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["diam_min"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["diam_max"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["major_axis"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["minor_axis"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["eccentricity"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["theta"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["solidity"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["circularity"],"name":[20],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"114.670","3":"91.252","4":"15.896","5":"32.768","6":"40.999","7":"2.253","8":"0.026","9":"4.931","10":"22.218","11":"192.057","12":"4.506","13":"0.051","14":"9.861","15":"6.956","16":"0.357","17":"0.606","18":"-0.258","19":"0.485","20":"0.119","_rn_":"1"},{"1":"2","2":"113.051","3":"244.551","4":"18.747","5":"42.155","6":"45.925","7":"2.534","8":"0.071","9":"5.896","10":"24.435","11":"82.740","12":"5.068","13":"0.143","14":"11.792","15":"8.406","16":"0.431","17":"0.626","18":"0.706","19":"0.445","20":"0.112","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="several-images-of-the-same-sample" class="section level1" number="13">
<h1><span class="header-section-number">13</span> Several images of the same sample</h1>
<p>If users need to analyze several images of the same sample the images of the same sample should share the same filename prefix, which is defined as the part of the filename preceding the first hyphen (<code>-</code>) or underscore (<code>_</code>). Then, when using <code>get_measures()</code>, the measures of leaf images named, for example, <code>F1-1.jpeg</code>, <code>F1_2.jpeg</code>, and <code>F1-3.jpeg</code> will be combined into a single image (<code>F1</code>), shown in the <code>merge</code> object. This is useful, for example, to analyze large leaves that need to be split into multiple images, or several leaves belonging to the same sample that cannot be scanned in a unique image.</p>
<p>In the following example, five images will be used as motivating examples. Each image has leaves from different species. The images were split into different images sharing the same prefix (e.g., L1_*, L2_*, and so on). Note that to ensure that all images are processed, all images must share a common pattern, in this case (“L”). The three points at the right-bottom corner have a known distance of 5 cm between them, which can be used to extract the image dpi with <code>dpi()</code>. Just for teaching purposes, I will consider that all the images have a resolution of 100 dpi.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>path_multiple <span class="ot">&lt;-</span> <span class="st">&quot;./data/leaf_area/multiple&quot;</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="co"># whole images</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>imgs <span class="ot">&lt;-</span> </span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">&quot;leaf&quot;</span>,</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">path =</span> path_multiple,</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/merge0-1.png" width="960" /></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sample images</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>sample_imgs <span class="ot">&lt;-</span> </span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">&quot;L&quot;</span>,</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">path =</span> path_multiple,</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">ncol =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/merge0-2.png" width="960" /></p>
<div id="compute-the-measures-for-the-subsamples" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> Compute the measures for the subsamples</h2>
<p>Here, I will use the <code>pattern = "L"</code> to indicate that all the images with this pattern name should be analyzed. The green index (<code>"G"</code>) is used to segment the leaves and <code>watershed = FALSE</code> is used to omit the watershed segmentation algorithm.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> </span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;L&quot;</span>,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> path_multiple)</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Processing image L1_1 |====                                      | 8% 00:00:00 </span></span></code></pre></div>
<p><img src="code_files/figure-html/merge1-1.png" width="768" /></p>
<pre><code>## Processing image L1_2 |=======                                   | 17% 00:00:00 </code></pre>
<p><img src="code_files/figure-html/merge1-2.png" width="768" /></p>
<pre><code>## Processing image L2_1 |==========                                | 25% 00:00:00 </code></pre>
<p><img src="code_files/figure-html/merge1-3.png" width="768" /></p>
<pre><code>## Processing image L2_2 |==============                            | 33% 00:00:00 </code></pre>
<p><img src="code_files/figure-html/merge1-4.png" width="768" /></p>
<pre><code>## Processing image L3_1 |==================                        | 42% 00:00:01 </code></pre>
<p><img src="code_files/figure-html/merge1-5.png" width="768" /></p>
<pre><code>## Processing image L3_2 |=====================                     | 50% 00:00:01 </code></pre>
<p><img src="code_files/figure-html/merge1-6.png" width="768" /></p>
<pre><code>## Processing image L3_3 |========================                  | 58% 00:00:01 </code></pre>
<p><img src="code_files/figure-html/merge1-7.png" width="768" /></p>
<pre><code>## Processing image L4_1 |============================              | 67% 00:00:01 </code></pre>
<p><img src="code_files/figure-html/merge1-8.png" width="768" /></p>
<pre><code>## Processing image L4_2 |================================          | 75% 00:00:02 </code></pre>
<p><img src="code_files/figure-html/merge1-9.png" width="768" /></p>
<pre><code>## Processing image L4_3 |===================================       | 83% 00:00:02 </code></pre>
<p><img src="code_files/figure-html/merge1-10.png" width="768" /></p>
<pre><code>## Processing image L5_1 |======================================    | 92% 00:00:03 </code></pre>
<p><img src="code_files/figure-html/merge1-11.png" width="768" /></p>
<pre><code>## Processing image L5_2 |==========================================| 100% 00:00:03 
## --------------------------------------------
##  Image Objects
##   L1_1       1
##   L1_2       1
##   L2_1       2
##   L2_2       3
##   L3_1       1
##   L3_2       1
##   L3_3       1
##   L4_1       2
##   L4_2       2
##   L4_3       3
##   L5_1       3
##   L5_2       3
## --------------------------------------------
## Done!</code></pre>
<p><img src="code_files/figure-html/merge1-12.png" width="768" /></p>
<p>Using the function <code>get_measures()</code> it is possible to convert the measures from pixel to metric (cm<span class="math inline">\(^2\)</span>) units.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>merged_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(merged, <span class="at">dpi =</span> <span class="dv">100</span>)</span></code></pre></div>
<p>Note that the <code>merged_cor</code> is a list with three objects</p>
<ul>
<li><code>results</code>: a data frame that contains the measures for each object (in this case leaf) of each analyzed image.</li>
</ul>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>merged_cor<span class="sc">$</span>results</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["img"],"name":[1],"type":["chr"],"align":["left"]},{"label":["id"],"name":[2],"type":["int"],"align":["right"]},{"label":["x"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["area"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["area_ch"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["perimeter"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["radius_mean"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["radius_min"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["radius_max"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["radius_sd"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["radius_ratio"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["diam_mean"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["diam_min"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["diam_max"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["major_axis"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["minor_axis"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["eccentricity"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["theta"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["solidity"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["circularity"],"name":[21],"type":["dbl"],"align":["right"]}],"data":[{"1":"L1_1","2":"1","3":"427.723","4":"516.719","5":"102.170","6":"292.253","7":"115.189","8":"6.217","9":"0.561","10":"11.913","11":"114.118","12":"21.226","13":"12.435","14":"1.122","15":"23.826","16":"19.863","17":"0.505","18":"0.647","19":"0.158","20":"0.350","21":"0.097"},{"1":"L1_2","2":"1","3":"372.556","4":"526.031","5":"92.840","6":"207.023","7":"107.188","8":"5.341","9":"1.042","10":"10.168","11":"86.064","12":"9.754","13":"10.682","14":"2.085","15":"20.336","16":"15.123","17":"0.384","18":"0.486","19":"0.600","20":"0.448","21":"0.102"},{"1":"L2_1","2":"1","3":"251.404","4":"282.798","5":"46.319","6":"46.789","7":"24.003","8":"3.936","9":"2.527","10":"5.920","11":"35.873","12":"2.342","13":"7.872","14":"5.054","15":"11.840","16":"10.479","17":"0.266","18":"0.839","19":"1.502","20":"0.990","21":"1.010"},{"1":"L2_1","2":"2","3":"146.366","4":"701.900","5":"35.305","6":"36.136","7":"21.488","8":"3.441","9":"2.311","10":"5.209","11":"32.274","12":"2.254","13":"6.881","14":"4.621","15":"10.417","16":"9.308","17":"0.236","18":"0.852","19":"-1.533","20":"0.977","21":"0.961"},{"1":"L2_2","2":"1","3":"326.113","4":"391.141","5":"19.026","6":"19.221","7":"16.739","8":"2.613","9":"1.659","10":"4.129","11":"29.010","12":"2.488","13":"5.225","14":"3.319","15":"8.259","16":"7.301","17":"0.185","18":"0.887","19":"1.560","20":"0.990","21":"0.853"},{"1":"L2_2","2":"2","3":"113.850","4":"755.321","5":"38.153","6":"38.670","7":"20.904","8":"3.534","9":"2.518","10":"5.097","11":"26.159","12":"2.024","13":"7.069","14":"5.036","15":"10.195","16":"8.955","17":"0.227","18":"0.792","19":"1.556","20":"0.987","21":"1.097"},{"1":"L2_2","2":"3","3":"376.213","4":"784.804","5":"16.320","6":"16.439","7":"14.580","8":"2.365","9":"1.532","10":"3.616","11":"23.766","12":"2.361","13":"4.730","14":"3.063","15":"7.231","16":"6.509","17":"0.165","18":"0.867","19":"1.395","20":"0.993","21":"0.965"},{"1":"L3_1","2":"1","3":"253.962","4":"480.290","5":"64.082","6":"117.849","7":"79.324","8":"4.199","9":"0.408","10":"9.476","11":"80.727","12":"23.207","13":"8.397","14":"0.817","15":"18.952","16":"15.225","17":"0.387","18":"0.822","19":"-1.550","20":"0.544","21":"0.128"},{"1":"L3_2","2":"1","3":"200.077","4":"436.484","5":"30.205","6":"57.570","7":"54.813","8":"2.830","9":"0.065","10":"6.576","11":"56.098","12":"100.588","13":"5.661","14":"0.131","15":"13.152","16":"9.857","17":"0.250","18":"0.693","19":"1.564","20":"0.525","21":"0.126"},{"1":"L3_3","2":"1","3":"204.984","4":"363.476","5":"52.026","6":"87.382","7":"80.137","8":"3.494","9":"0.077","10":"7.821","11":"65.208","12":"101.216","13":"6.989","14":"0.155","15":"15.641","16":"12.404","17":"0.315","18":"0.735","19":"1.538","20":"0.595","21":"0.102"},{"1":"L4_1","2":"1","3":"270.258","4":"326.544","5":"54.355","6":"54.773","7":"24.638","8":"4.177","9":"3.390","10":"5.717","11":"21.940","12":"1.686","13":"8.354","14":"6.780","15":"11.434","16":"9.918","17":"0.252","18":"0.705","19":"1.484","20":"0.992","21":"1.125"},{"1":"L4_1","2":"3","3":"252.952","4":"845.157","5":"61.679","6":"63.975","7":"28.499","8":"4.540","9":"3.654","10":"6.488","11":"27.727","12":"1.776","13":"9.080","14":"7.307","15":"12.975","16":"10.549","17":"0.268","18":"0.699","19":"1.428","20":"0.964","21":"0.954"},{"1":"L4_2","2":"1","3":"291.942","4":"235.565","5":"61.503","6":"62.870","7":"28.067","8":"4.544","9":"3.148","10":"6.592","11":"32.407","12":"2.094","13":"9.087","14":"6.297","15":"13.183","16":"10.970","17":"0.279","18":"0.748","19":"-1.332","20":"0.978","21":"0.981"},{"1":"L4_2","2":"2","3":"260.787","4":"799.754","5":"73.268","6":"75.388","7":"30.658","8":"4.938","9":"3.787","10":"7.013","11":"30.654","12":"1.852","13":"9.876","14":"7.574","15":"14.026","16":"11.609","17":"0.295","18":"0.712","19":"1.527","20":"0.972","21":"0.980"},{"1":"L4_3","2":"1","3":"206.166","4":"213.417","5":"29.186","6":"29.581","7":"19.279","8":"3.097","9":"2.054","10":"4.374","11":"26.315","12":"2.130","13":"6.193","14":"4.107","15":"8.748","16":"8.256","17":"0.210","18":"0.836","19":"-1.536","20":"0.987","21":"0.987"},{"1":"L4_3","2":"2","3":"219.514","4":"552.896","5":"19.503","6":"20.439","7":"16.713","8":"2.595","9":"1.608","10":"3.940","11":"25.493","12":"2.451","13":"5.191","14":"3.215","15":"7.881","16":"7.069","17":"0.180","18":"0.865","19":"1.538","20":"0.954","21":"0.877"},{"1":"L4_3","2":"3","3":"229.163","4":"937.157","5":"34.149","6":"35.426","7":"23.520","8":"3.470","9":"2.211","10":"5.138","11":"31.462","12":"2.324","13":"6.940","14":"4.421","15":"10.277","16":"8.809","17":"0.224","18":"0.816","19":"1.471","20":"0.964","21":"0.776"},{"1":"L5_1","2":"1","3":"225.338","4":"275.720","5":"52.797","6":"54.448","7":"31.217","8":"4.590","9":"2.259","10":"7.735","11":"63.899","12":"3.425","13":"9.179","14":"4.517","15":"15.470","16":"13.610","17":"0.346","18":"0.929","19":"-1.479","20":"0.970","21":"0.681"},{"1":"L5_1","2":"2","3":"335.525","4":"884.869","5":"31.675","6":"32.608","7":"24.460","8":"3.619","9":"1.727","10":"6.199","11":"52.019","12":"3.590","13":"7.237","14":"3.454","15":"12.398","16":"10.718","17":"0.272","18":"0.934","19":"1.382","20":"0.971","21":"0.665"},{"1":"L5_1","2":"3","3":"120.360","4":"887.853","5":"30.192","6":"32.323","7":"27.102","8":"3.827","9":"1.649","10":"6.774","11":"59.974","12":"4.109","13":"7.654","14":"3.297","15":"13.549","16":"11.055","17":"0.281","18":"0.946","19":"-1.564","20":"0.934","21":"0.517"},{"1":"L5_2","2":"1","3":"339.022","4":"300.133","5":"45.622","6":"46.825","7":"30.023","8":"4.331","9":"2.188","10":"7.465","11":"63.358","12":"3.412","13":"8.662","14":"4.376","15":"14.930","16":"13.160","17":"0.334","18":"0.941","19":"-1.547","20":"0.974","21":"0.636"},{"1":"L5_2","2":"2","3":"205.390","4":"802.624","5":"42.866","6":"43.898","7":"29.464","8":"4.267","9":"2.060","10":"7.335","11":"62.330","12":"3.561","13":"8.534","14":"4.120","15":"14.670","16":"12.766","17":"0.324","18":"0.940","19":"1.508","20":"0.976","21":"0.621"},{"1":"L5_2","2":"3","3":"535.301","4":"819.600","5":"44.996","6":"46.294","7":"29.337","8":"4.300","9":"1.992","10":"7.465","11":"62.372","12":"3.748","13":"8.600","14":"3.984","15":"14.930","16":"13.069","17":"0.332","18":"0.940","19":"-1.450","20":"0.972","21":"0.657"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<ul>
<li><code>summary</code>: a data frame that contains the summary of the results, containing the number of objects in each image (<code>n</code>) the sum, mean, and standard deviation of the area of each image, as well as the mean value for all the other measures (perimeter, radius, etc.)</li>
</ul>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>merged_cor<span class="sc">$</span>summary</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["img"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]},{"label":["area_sum"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["area_mean"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["area_sd"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["area_ch"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["perimeter"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["radius_mean"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["radius_min"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["radius_max"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["radius_sd"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["radius_ratio"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["diam_mean"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["diam_min"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["diam_max"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["major_axis"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["minor_axis"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["eccentricity"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["theta"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["solidity"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["circularity"],"name":[21],"type":["dbl"],"align":["right"]}],"data":[{"1":"L1_1","2":"1","3":"102.170","4":"102.170","5":"0.000","6":"292.253","7":"115.189","8":"6.217","9":"0.561","10":"11.913","11":"114.118","12":"21.226","13":"12.435","14":"1.122","15":"23.826","16":"19.863","17":"0.505","18":"0.647","19":"0.158","20":"0.350","21":"0.097"},{"1":"L1_2","2":"1","3":"92.840","4":"92.840","5":"0.000","6":"207.023","7":"107.188","8":"5.341","9":"1.042","10":"10.168","11":"86.064","12":"9.754","13":"10.682","14":"2.085","15":"20.336","16":"15.123","17":"0.384","18":"0.486","19":"0.600","20":"0.448","21":"0.102"},{"1":"L2_1","2":"2","3":"81.624","4":"40.812","5":"7.788","6":"41.462","7":"22.746","8":"3.688","9":"2.419","10":"5.564","11":"34.073","12":"2.298","13":"7.377","14":"4.838","15":"11.128","16":"9.893","17":"0.251","18":"0.845","19":"-0.016","20":"0.983","21":"0.986"},{"1":"L2_2","2":"3","3":"73.500","4":"24.500","5":"11.901","6":"24.777","7":"17.407","8":"2.837","9":"1.903","10":"4.281","11":"26.312","12":"2.291","13":"5.675","14":"3.806","15":"8.562","16":"7.588","17":"0.193","18":"0.849","19":"1.504","20":"0.990","21":"0.972"},{"1":"L3_1","2":"1","3":"64.082","4":"64.082","5":"0.000","6":"117.849","7":"79.324","8":"4.199","9":"0.408","10":"9.476","11":"80.727","12":"23.207","13":"8.397","14":"0.817","15":"18.952","16":"15.225","17":"0.387","18":"0.822","19":"-1.550","20":"0.544","21":"0.128"},{"1":"L3_2","2":"1","3":"30.205","4":"30.205","5":"0.000","6":"57.570","7":"54.813","8":"2.830","9":"0.065","10":"6.576","11":"56.098","12":"100.588","13":"5.661","14":"0.131","15":"13.152","16":"9.857","17":"0.250","18":"0.693","19":"1.564","20":"0.525","21":"0.126"},{"1":"L3_3","2":"1","3":"52.026","4":"52.026","5":"0.000","6":"87.382","7":"80.137","8":"3.494","9":"0.077","10":"7.821","11":"65.208","12":"101.216","13":"6.989","14":"0.155","15":"15.641","16":"12.404","17":"0.315","18":"0.735","19":"1.538","20":"0.595","21":"0.102"},{"1":"L4_1","2":"2","3":"116.034","4":"58.017","5":"5.178","6":"59.374","7":"26.568","8":"4.358","9":"3.522","10":"6.102","11":"24.833","12":"1.731","13":"8.717","14":"7.044","15":"12.205","16":"10.233","17":"0.260","18":"0.702","19":"1.456","20":"0.978","21":"1.040"},{"1":"L4_2","2":"2","3":"134.771","4":"67.385","5":"8.319","6":"69.129","7":"29.362","8":"4.741","9":"3.468","10":"6.802","11":"31.530","12":"1.973","13":"9.482","14":"6.936","15":"13.605","16":"11.289","17":"0.287","18":"0.730","19":"0.097","20":"0.975","21":"0.980"},{"1":"L4_3","2":"3","3":"82.838","4":"27.613","5":"7.449","6":"28.482","7":"19.837","8":"3.054","9":"1.957","10":"4.484","11":"27.757","12":"2.302","13":"6.108","14":"3.915","15":"8.968","16":"8.045","17":"0.204","18":"0.839","19":"0.491","20":"0.968","21":"0.880"},{"1":"L5_1","2":"3","3":"114.664","4":"38.221","5":"12.645","6":"39.793","7":"27.593","8":"4.012","9":"1.878","10":"6.903","11":"58.631","12":"3.708","13":"8.023","14":"3.756","15":"13.806","16":"11.795","17":"0.300","18":"0.937","19":"-0.554","20":"0.958","21":"0.621"},{"1":"L5_2","2":"3","3":"133.484","4":"44.495","5":"1.445","6":"45.672","7":"29.608","8":"4.299","9":"2.080","10":"7.422","11":"62.687","12":"3.573","13":"8.599","14":"4.160","15":"14.843","16":"12.998","17":"0.330","18":"0.940","19":"-0.496","20":"0.974","21":"0.638"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<ul>
<li><code>merge</code>: a data frame that contains the results merged by the image prefix. Note that in this case, the results are presented by L1, L2, L3, L4, and L5.</li>
</ul>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>merged_cor<span class="sc">$</span>merge</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["img"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]},{"label":["area_sum"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["area_mean"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["area_sd"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["area_ch"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["perimeter"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["radius_mean"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["radius_min"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["radius_max"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["radius_sd"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["radius_ratio"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["diam_mean"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["diam_min"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["diam_max"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["major_axis"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["minor_axis"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["eccentricity"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["theta"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["solidity"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["circularity"],"name":[21],"type":["dbl"],"align":["right"]}],"data":[{"1":"L1","2":"2","3":"195.010","4":"97.505","5":"0.000","6":"249.638","7":"111.189","8":"5.779","9":"0.802","10":"11.040","11":"100.091","12":"15.490","13":"11.558","14":"1.604","15":"22.081","16":"17.493","17":"0.444","18":"0.567","19":"0.379","20":"0.399","21":"0.099"},{"1":"L2","2":"5","3":"155.124","4":"32.656","5":"9.845","6":"33.120","7":"20.077","8":"3.263","9":"2.161","10":"4.922","11":"30.192","12":"2.295","13":"6.526","14":"4.322","15":"9.845","16":"8.741","17":"0.222","18":"0.847","19":"0.744","20":"0.987","21":"0.979"},{"1":"L3","2":"3","3":"146.313","4":"48.771","5":"0.000","6":"87.600","7":"71.425","8":"3.508","9":"0.184","10":"7.958","11":"67.344","12":"75.004","13":"7.016","14":"0.367","15":"15.915","16":"12.495","17":"0.317","18":"0.750","19":"0.517","20":"0.555","21":"0.119"},{"1":"L4","2":"7","3":"333.643","4":"51.005","5":"6.982","6":"52.328","7":"25.256","8":"4.051","9":"2.982","10":"5.796","11":"28.040","12":"2.002","13":"8.102","14":"5.965","15":"11.592","16":"9.856","17":"0.250","18":"0.757","19":"0.681","20":"0.974","21":"0.967"},{"1":"L5","2":"6","3":"248.149","4":"41.358","5":"7.045","6":"42.733","7":"28.600","8":"4.156","9":"1.979","10":"7.162","11":"60.659","12":"3.641","13":"8.311","14":"3.958","15":"14.325","16":"12.396","17":"0.315","18":"0.938","19":"-0.525","20":"0.966","21":"0.629"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The <code>area_sum</code> of img <code>L1</code> is the sum of the two leaves (one in each image)</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(merged_cor<span class="sc">$</span>results<span class="sc">$</span>area[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 195.01</span></span></code></pre></div>
</div>
<div id="compute-the-measures-for-the-whole-images" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> Compute the measures for the whole images</h2>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>whole <span class="ot">&lt;-</span> </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(<span class="at">pattern =</span> <span class="st">&quot;leaf&quot;</span>,</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_original =</span> path_multiple)</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Processing image leaf1 |========                                 | 20% 00:00:00 </span></span></code></pre></div>
<p><img src="code_files/figure-html/merge7-1.png" width="768" /></p>
<pre><code>## Processing image leaf2 |================                         | 40% 00:00:00 </code></pre>
<p><img src="code_files/figure-html/merge7-2.png" width="768" /></p>
<pre><code>## Processing image leaf3 |=========================                | 60% 00:00:01 </code></pre>
<p><img src="code_files/figure-html/merge7-3.png" width="768" /></p>
<pre><code>## Processing image leaf4 |=================================        | 80% 00:00:01 </code></pre>
<p><img src="code_files/figure-html/merge7-4.png" width="768" /></p>
<pre><code>## Processing image leaf5 |=========================================| 100% 00:00:02 
## --------------------------------------------
##  Image Objects
##  leaf1       2
##  leaf2       5
##  leaf3       3
##  leaf4       7
##  leaf5       6
## --------------------------------------------
## Done!</code></pre>
<p><img src="code_files/figure-html/merge7-5.png" width="768" /></p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>whole_cor <span class="ot">&lt;-</span> <span class="fu">get_measures</span>(whole, <span class="at">dpi =</span> <span class="dv">100</span>)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>whole_cor<span class="sc">$</span>summary</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["img"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]},{"label":["area_sum"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["area_mean"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["area_sd"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["area_ch"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["perimeter"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["radius_mean"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["radius_min"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["radius_max"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["radius_sd"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["radius_ratio"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["diam_mean"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["diam_min"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["diam_max"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["major_axis"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["minor_axis"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["eccentricity"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["theta"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["solidity"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["circularity"],"name":[21],"type":["dbl"],"align":["right"]}],"data":[{"1":"leaf1","2":"2","3":"194.958","4":"97.479","5":"5.940","6":"249.998","7":"111.481","8":"5.780","9":"0.805","10":"11.057","11":"100.085","12":"15.428","13":"11.560","14":"1.610","15":"22.113","16":"17.494","17":"0.444","18":"0.566","19":"0.379","20":"0.398","21":"0.099"},{"1":"leaf2","2":"5","3":"155.384","4":"31.077","5":"12.929","6":"31.511","7":"19.573","8":"3.180","9":"2.112","10":"4.794","11":"29.439","12":"2.293","13":"6.360","14":"4.224","15":"9.589","16":"8.515","17":"0.216","18":"0.847","19":"0.896","20":"0.987","21":"0.976"},{"1":"leaf3","2":"3","3":"146.138","4":"48.713","5":"17.131","6":"87.577","7":"71.560","8":"3.507","9":"0.190","10":"7.955","11":"67.250","12":"68.405","13":"7.013","14":"0.381","15":"15.910","16":"12.496","17":"0.317","18":"0.750","19":"0.517","20":"0.554","21":"0.118"},{"1":"leaf4","2":"7","3":"332.072","4":"47.439","5":"19.715","6":"48.713","7":"24.424","8":"3.900","9":"2.807","10":"5.618","11":"28.350","12":"2.062","13":"7.801","14":"5.614","15":"11.237","16":"9.616","17":"0.244","18":"0.773","19":"0.654","20":"0.973","21":"0.957"},{"1":"leaf5","2":"6","3":"248.174","4":"41.362","5":"8.722","6":"42.720","7":"28.617","8":"4.157","9":"1.980","10":"7.170","11":"60.707","12":"3.643","13":"8.314","14":"3.959","15":"14.340","16":"12.401","17":"0.315","18":"0.938","19":"-0.525","20":"0.967","21":"0.629"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="area-and-solidity-for-different-species" class="section level2" number="13.3">
<h2><span class="header-section-number">13.3</span> Area and solidity for different species</h2>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># isolate the object 2 of each leaf</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> </span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_isolate</span>(imgs,</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">id =</span> <span class="dv">2</span>,</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">index =</span> <span class="st">&quot;HUE2&quot;</span>,</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">watershed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(samples, <span class="at">ncol =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/merge8-1.png" width="960" /></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>df_leaf <span class="ot">&lt;-</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  merged_cor<span class="sc">$</span>results <span class="sc">%&gt;%</span> </span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(img, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;code&quot;</span>))</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="co"># leaf area of the different species</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> </span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(df_leaf, <span class="fu">aes</span>(<span class="at">x =</span> img, <span class="at">y =</span> area)) <span class="sc">+</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Image&quot;</span>, <span class="at">y =</span> <span class="fu">expression</span>(Area<span class="sc">~</span>(cm<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a><span class="co"># solidity of the different species</span></span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> </span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(df_leaf, <span class="fu">aes</span>(<span class="at">x =</span> img, <span class="at">y =</span> solidity)) <span class="sc">+</span></span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Image&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Leaf solidity&quot;</span>)</span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-21"><a href="#cb142-21" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 </span></code></pre></div>
<p><img src="code_files/figure-html/merge9-1.png" width="768" /></p>
</div>
</div>
<div id="rgb-values-for-each-object" class="section level1" number="14">
<h1><span class="header-section-number">14</span> RGB values for each object</h1>
<p>To obtain the RGB intensity of each image object we use the argument <code>object_rgb = TRUE</code> in the function <code>analyze_objects()</code>. In this example,</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;./data/objects_rgb/thetrazolium.jpg&quot;</span>)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="co"># identify the index that better segments the image</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">image_binary</span>(img, <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/rgb1-1.png" width="960" /></p>
<p>The index <code>HUE2</code> was chosen to segment the grains from the background. The mean of blue values will be computed by declaring <code>object_index = "B"</code>.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(img,</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;HUE2&quot;</span>,</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">object_index =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill_hull =</span> <span class="cn">TRUE</span>,</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">marker_col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/rgb2-1.png" width="960" /></p>
<div id="plot-the-index" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> Plot the index</h2>
<p>Here, I use <code>image_segment()</code> and <code>plot_measures()</code> to plot the mean of blue values for each object.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image_segment</span>(img,</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">index =</span> <span class="st">&quot;HUE2&quot;</span>,</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_measures</span>(ids,</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">measure =</span> <span class="st">&quot;B&quot;</span>, <span class="co"># plot the mean of blue values for each object</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/rgb3-1.png" width="960" /></p>
<p>It seems that grains with mean blue values higher than 0.3 present some level of damage. Users can then work with this feature and adapt it to their case.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(ids<span class="sc">$</span>results<span class="sc">$</span>index <span class="sc">&gt;</span> <span class="fl">0.3</span>))</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0</span></span></code></pre></div>
</div>
<div id="large-number-of-objects" class="section level2" number="14.2">
<h2><span class="header-section-number">14.2</span> Large number of objects</h2>
<p>When a lot of objects exist, the <code>parallel = TRUE</code> argument will speed up the extraction of the RGB values. In the following example, an image with 1343 grains of <em>Vicia cracca</em> is analyzed. The grains with an average red value higher than 0.25 are highlighted.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;./data/objects_rgb/vicia.jpg&quot;</span>)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>vicia <span class="ot">&lt;-</span> </span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">analyze_objects</span>(img,</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">object_index =</span> <span class="st">&quot;R&quot;</span>,</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">which</span>(vicia<span class="sc">$</span>object_index<span class="sc">$</span>index <span class="sc">&gt;</span> <span class="fl">0.25</span>)</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>cont <span class="ot">&lt;-</span> </span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">object_contour</span>(img,</span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">index =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(img)</span></code></pre></div>
<p><img src="code_files/figure-html/rgb5-1.png" width="960" /></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_contour</span>(cont, <span class="at">id =</span> id)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create an histogram of the RGB values for the two classes of grains</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>rgbs <span class="ot">&lt;-</span> </span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>  vicia<span class="sc">$</span>object_rgb <span class="sc">%&gt;%</span> </span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">ifelse</span>(object <span class="sc">%in%</span> id, <span class="st">&quot;Highlighted &quot;</span>, <span class="st">&quot;Not highlighted&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>object) <span class="sc">%&gt;%</span> </span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>type)</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rgbs, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> name), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type)</span></code></pre></div>
<p><img src="code_files/figure-html/rgb5-2.png" width="960" /></p>
</div>
</div>
<div id="object-identification-id" class="section level1" number="15">
<h1><span class="header-section-number">15</span> Object identification (id)</h1>
<p>Knowing the object identification (id) is useful, for example, when correcting the objects’ measures by the measure of some object, e.g., with <code>get_measures()</code>. To get the object id, we use <code>object_id()</code>.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_pliman</span>(<span class="st">&quot;la_leaves.jpg&quot;</span>)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">object_id</span>(img)</span></code></pre></div>
<p><img src="code_files/figure-html/objec1-1.png" width="768" /></p>
</div>
<div id="object-coordinates" class="section level1" number="16">
<h1><span class="header-section-number">16</span> Object coordinates</h1>
<p>Users can get the coordinates for all or desired objects with <code>object_coord()</code>. When the <code>id</code> argument is set to <code>NULL</code> (default), a bounding rectangle is drawn including all the objects. Set <code>id = "all"</code> to compute the coordinates for all objects in the image, or use a numeric vector to indicate the objects to compute the coordinates</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the coordinates for a bounding rectangle around all objects</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">object_coord</span>(img)</span></code></pre></div>
<p><img src="code_files/figure-html/objec2-1.png" width="768" /></p>
<pre><code>## $col_min
## [1] 13
## 
## $col_max
## [1] 692
## 
## $row_min
## [1] 21
## 
## $row_max
## [1] 641

# Get the coordinates for all objects
object_coord(img, id = &quot;all&quot;)</code></pre>
<p><img src="code_files/figure-html/objec2-2.png" width="768" /></p>
<pre><code>## $col_min
## [1] 320  13 304  21 358 619
## 
## $col_max
## [1] 641 297 606 288 505 692
## 
## $row_min
## [1] 436 338  21  93 268 279
## 
## $row_max
## [1] 641 537 202 266 363 348

# Get the coordinates of objects 1 and 3
object_coord(img, id = c(2, 3))</code></pre>
<p><img src="code_files/figure-html/objec2-3.png" width="768" /></p>
<pre><code>## $col_min
## [1]  13 304
## 
## $col_max
## [1] 297 606
## 
## $row_min
## [1] 338  21
## 
## $row_max
## [1] 537 202</code></pre>
</div>
<div id="isolating-objects" class="section level1" number="17">
<h1><span class="header-section-number">17</span> Isolating objects</h1>
<p>To isolate objects, the function <code>object_isolate()</code> is used. In the following example, I will isolate object 1 and set an edge of 10 pixels around the object.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> <span class="fu">object_isolate</span>(img, <span class="at">id =</span> <span class="dv">1</span>, <span class="at">edge =</span> <span class="dv">10</span>)</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(id1)</span></code></pre></div>
<p><img src="code_files/figure-html/objec3-1.png" width="768" /></p>
</div>
<div id="phytopathometry" class="section level1" number="18">
<h1><span class="header-section-number">18</span> Phytopathometry</h1>
<div id="single-images" class="section level2" number="18.1">
<h2><span class="header-section-number">18.1</span> Single images</h2>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set the path directory</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>path_soy <span class="ot">&lt;-</span> <span class="st">&quot;./data/disease_severity/soybean&quot;</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="co"># import images</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;leaf.jpg&quot;</span>, <span class="at">path =</span> path_soy)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>healthy <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;healthy.jpg&quot;</span>, <span class="at">path =</span> path_soy)</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>symptoms <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;sympt.jpg&quot;</span>, <span class="at">path =</span> path_soy)</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>background <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;back.jpg&quot;</span>, <span class="at">path =</span> path_soy)</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(img, healthy, symptoms, background, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/disease1-1.png" width="1152" /></p>
</div>
<div id="image-palettes" class="section level2" number="18.2">
<h2><span class="header-section-number">18.2</span> Image palettes</h2>
<p>Sample palettes can be made by simply manually sampling small areas of representative images and producing a composite image that will represent each of the desired classes (background, healthy, and symptomatic tissues). Another way is to use the <code>image_palette()</code> function to create sample color palettes</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>pals <span class="ot">&lt;-</span> <span class="fu">image_palette</span>(img, <span class="at">npal =</span> <span class="dv">8</span>)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(pals, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-14-1.png" width="768" /></p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>rust_path <span class="ot">&lt;-</span> <span class="st">&quot;./data/disease_severity/soybean_rust/single&quot;</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="co"># default settings</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">measure_disease</span>(<span class="at">img =</span> img,</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_healthy =</span> healthy,</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_symptoms =</span> symptoms,</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_background =</span> background,</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">save_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_processed =</span> rust_path)</span></code></pre></div>
<p><img src="code_files/figure-html/disease2-1.png" width="960" /></p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create a personalized mask</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="fu">measure_disease</span>(<span class="at">img =</span> img,</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">img_healthy =</span> healthy,</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">img_symptoms =</span> symptoms,</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">img_background =</span> background,</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">save_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_original =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">prefix =</span> <span class="st">&quot;proc_mask_&quot;</span>,</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">dir_processed =</span> rust_path)</span></code></pre></div>
<p><img src="code_files/figure-html/disease2-2.png" width="960" /></p>
<pre><code>## $severity
##    healthy symptomatic
## 1 89.08467    10.91533
## 
## $shape
## NULL
## 
## $statistics
## NULL
## 
## attr(,&quot;class&quot;)
## [1] &quot;plm_disease&quot;

# import generated masks
masks &lt;- image_import(pattern = &quot;img&quot;, path = rust_path)

# combine the masks with the original image
image_combine(masks, ncol = 3)</code></pre>
<p><img src="code_files/figure-html/disease2-3.png" width="960" /></p>
</div>
<div id="variations-in-image-palettes" class="section level2" number="18.3">
<h2><span class="header-section-number">18.3</span> Variations in image palettes</h2>
<p>In the following example, I show a second example with a variation in the color palettes, where only the necrotic area is assumed to be the diseased tissue. Therefore, the symptomatic area will be smaller than the previous one.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="co"># set the path directory</span></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>path_soy <span class="ot">&lt;-</span> <span class="st">&quot;./data/disease_severity/soybean&quot;</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="co"># import images</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>healthy2 <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;healthy2.jpg&quot;</span>, <span class="at">path =</span> path_soy)</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>symptoms2 <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;sympt2.jpg&quot;</span>, <span class="at">path =</span> path_soy)</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>background2 <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;back2.jpg&quot;</span>, <span class="at">path =</span> path_soy)</span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(healthy2, symptoms2, background2, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/disease3-1.png" width="960" /></p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>img2 <span class="ot">&lt;-</span> img</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">measure_disease</span>(<span class="at">img =</span> img2,</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_healthy =</span> healthy2,</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_symptoms =</span> symptoms2,</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">img_background =</span> background2,</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">contour_col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">save_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prefix =</span> <span class="st">&quot;proc2_&quot;</span>,</span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dir_processed =</span> <span class="st">&quot;./data/disease_severity/soybean_rust/single&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/disease3-2.png" width="960" /></p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>severity</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["healthy"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["symptomatic"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"93.85779","2":"6.142209"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>imgs_pal <span class="ot">&lt;-</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_import</span>(<span class="fu">c</span>(<span class="st">&quot;proc_img.jpg&quot;</span>, <span class="st">&quot;proc2_img.jpg&quot;</span>),</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">path =</span> <span class="st">&quot;./data/disease_severity/soybean_rust/single&quot;</span>)</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(imgs_pal)</span></code></pre></div>
<p><img src="code_files/figure-html/disease3-3.png" width="960" /></p>
</div>
<div id="batch-processing" class="section level2" number="18.4">
<h2><span class="header-section-number">18.4</span> Batch processing</h2>
<p>Fifty soybean leaves and 19 bean leaves previously processed in APS Assess software were used. The soybean images were retrieved from <a href="https://osf.io/4hbr6" class="uri">https://osf.io/4hbr6</a>, a Plant Disease Severity Annotation Image Database. Thanks to <a href="https://osf.io/jb6yd/">Emerson M. Del Ponte</a> and his collaborators for keeping this important project publicly available.</p>
<div id="soybean-rust" class="section level3" number="18.4.1">
<h3><span class="header-section-number">18.4.1</span> Soybean rust</h3>
<div id="using-sample-palettes" class="section level4" number="18.4.1.1">
<h4><span class="header-section-number">18.4.1.1</span> Using sample palettes</h4>
<ul>
<li>Soybean leaves to be processed</li>
</ul>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># image directory</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>path_soy <span class="ot">&lt;-</span> <span class="st">&quot;./data/disease_severity/soybean_rust&quot;</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>soy_leaves <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">&quot;soy&quot;</span>, <span class="at">path =</span> path_soy)</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(soy_leaves, <span class="at">ncol =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/batch-1.png" width="960" /></p>
<ul>
<li>Image palettes with the different pixel classes</li>
</ul>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># image directory</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>path_soy <span class="ot">&lt;-</span> <span class="st">&quot;./data/disease_severity/soybean_rust&quot;</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>soy_palettes <span class="ot">&lt;-</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_import</span>(<span class="at">image =</span> <span class="fu">c</span>(<span class="st">&quot;back.png&quot;</span>, <span class="st">&quot;disease.png&quot;</span>, <span class="st">&quot;health.png&quot;</span>),</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">path =</span> path_soy)</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(soy_palettes, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/batch1-1.png" width="768" /></p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>rust_path <span class="ot">&lt;-</span> <span class="st">&quot;./data/disease_severity/soybean_rust&quot;</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>  soy_rust <span class="ot">&lt;-</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">measure_disease</span>(<span class="at">pattern =</span> <span class="st">&quot;soy_&quot;</span>,</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">img_symptoms =</span> <span class="st">&quot;disease&quot;</span>,</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">img_healthy =</span> <span class="st">&quot;health&quot;</span>,</span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">img_background =</span> <span class="st">&quot;back&quot;</span>,</span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dir_original =</span> rust_path,</span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dir_processed =</span> <span class="fu">paste0</span>(rust_path, <span class="st">&quot;/processed&quot;</span>),</span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">save_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb166-13"><a href="#cb166-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb166-14"><a href="#cb166-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Image processing using multiple sessions (6). Please wait.</span></span>
<span id="cb166-15"><a href="#cb166-15" aria-hidden="true" tabindex="-1"></a><span class="do">##   usuário   sistema decorrido </span></span>
<span id="cb166-16"><a href="#cb166-16" aria-hidden="true" tabindex="-1"></a><span class="do">##      0.24      0.01     25.44</span></span>
<span id="cb166-17"><a href="#cb166-17" aria-hidden="true" tabindex="-1"></a>soy_rust<span class="sc">$</span>severity</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["img"],"name":[1],"type":["chr"],"align":["left"]},{"label":["healthy"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["symptomatic"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"soy_1","2":"92.63609","3":"7.3639052"},{"1":"soy_10","2":"85.33469","3":"14.6653082"},{"1":"soy_11","2":"16.03577","3":"83.9642328"},{"1":"soy_12","2":"65.74042","3":"34.2595750"},{"1":"soy_13","2":"78.86412","3":"21.1358760"},{"1":"soy_14","2":"65.67188","3":"34.3281239"},{"1":"soy_15","2":"61.58017","3":"38.4198311"},{"1":"soy_16","2":"44.38025","3":"55.6197521"},{"1":"soy_17","2":"78.48053","3":"21.5194736"},{"1":"soy_18","2":"55.42864","3":"44.5713608"},{"1":"soy_19","2":"87.98059","3":"12.0194080"},{"1":"soy_2","2":"64.51764","3":"35.4823643"},{"1":"soy_20","2":"52.43467","3":"47.5653288"},{"1":"soy_21","2":"99.75300","3":"0.2469962"},{"1":"soy_22","2":"71.89163","3":"28.1083712"},{"1":"soy_23","2":"30.97342","3":"69.0265818"},{"1":"soy_24","2":"21.71080","3":"78.2892020"},{"1":"soy_25","2":"80.79449","3":"19.2055148"},{"1":"soy_26","2":"41.06141","3":"58.9385861"},{"1":"soy_27","2":"33.46471","3":"66.5352878"},{"1":"soy_28","2":"33.83941","3":"66.1605855"},{"1":"soy_29","2":"74.86804","3":"25.1319574"},{"1":"soy_3","2":"59.89314","3":"40.1068645"},{"1":"soy_30","2":"72.82859","3":"27.1714096"},{"1":"soy_31","2":"10.32248","3":"89.6775189"},{"1":"soy_32","2":"26.42826","3":"73.5717374"},{"1":"soy_33","2":"32.21538","3":"67.7846199"},{"1":"soy_34","2":"51.66514","3":"48.3348592"},{"1":"soy_35","2":"22.68147","3":"77.3185298"},{"1":"soy_36","2":"43.57711","3":"56.4228907"},{"1":"soy_37","2":"13.80292","3":"86.1970800"},{"1":"soy_38","2":"49.84490","3":"50.1550983"},{"1":"soy_39","2":"89.22211","3":"10.7778860"},{"1":"soy_4","2":"46.15893","3":"53.8410748"},{"1":"soy_40","2":"59.42983","3":"40.5701743"},{"1":"soy_41","2":"95.58053","3":"4.4194657"},{"1":"soy_42","2":"37.74140","3":"62.2585978"},{"1":"soy_43","2":"52.04795","3":"47.9520477"},{"1":"soy_44","2":"40.90434","3":"59.0956616"},{"1":"soy_45","2":"67.86825","3":"32.1317484"},{"1":"soy_46","2":"97.81241","3":"2.1875861"},{"1":"soy_47","2":"86.20738","3":"13.7926241"},{"1":"soy_48","2":"91.65338","3":"8.3466151"},{"1":"soy_49","2":"57.36250","3":"42.6374994"},{"1":"soy_5","2":"81.50603","3":"18.4939717"},{"1":"soy_50","2":"83.38668","3":"16.6133176"},{"1":"soy_6","2":"75.14625","3":"24.8537515"},{"1":"soy_7","2":"75.82929","3":"24.1707059"},{"1":"soy_8","2":"69.33675","3":"30.6632501"},{"1":"soy_9","2":"56.41083","3":"43.5891679"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># image directory</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>path_soy_proc <span class="ot">&lt;-</span> <span class="st">&quot;./data/disease_severity/soybean_rust/processed&quot;</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>soy_proc <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">&quot;proc&quot;</span>, <span class="at">path =</span> path_soy_proc)</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(soy_proc, <span class="at">ncol =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/batch3-1.png" width="960" /></p>
</div>
<div id="standard-area-diagrams" class="section level4" number="18.4.1.2">
<h4><span class="header-section-number">18.4.1.2</span> Standard Area Diagrams</h4>
<p>Standard area diagrams (SAD) have long been used as a tool to aid the estimation of plant disease severity, serving as a standard reference template before or during the assessments.</p>
<p>Given an object computed with <code>measure_disease()</code> a Standard Area Diagram (SAD) with <code>n</code> images containing the respective severity values are obtained with <code>sad()</code>.</p>
<p>Leaves with the smallest and highest severity will always be in the SAD. If <code>n = 1</code>, the leaf with the smallest severity will be returned. The others are sampled sequentially to achieve the n images after severity has been ordered in ascending order. For example, if there are 30 leaves and n is set to 3, the leaves sampled will be the 1st, 15th, and 30th with the smallest severity values.</p>
<p>The SAD can be only computed if an image pattern name is used in argument <code>pattern</code> of <code>measure_disease()</code>. If the images are saved, the <code>n</code> images will be retrevied from <code>dir_processed</code> directory. Otherwise, the severity will be computed again to generate the images. A SAD with 8 images from the above example can be obtained easely with:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sad</span>(soy_rust, <span class="at">n =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<img src="code_files/figure-html/sad-1.png" width="960" />
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["img"],"name":[1],"type":["chr"],"align":["left"]},{"label":["healthy"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["symptomatic"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["rank"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"soy_21","2":"99.75300","3":"0.2469962","4":"1","_rn_":"14"},{"1":"soy_29","2":"74.86804","3":"25.1319574","4":"17","_rn_":"22"},{"1":"soy_34","2":"51.66514","3":"48.3348592","4":"33","_rn_":"28"},{"1":"soy_31","2":"10.32248","3":"89.6775189","4":"50","_rn_":"25"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sad</span>(soy_rust, <span class="at">n =</span> <span class="dv">8</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<img src="code_files/figure-html/sad-2.png" width="960" />
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["img"],"name":[1],"type":["chr"],"align":["left"]},{"label":["healthy"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["symptomatic"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["rank"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"soy_21","2":"99.75300","3":"0.2469962","4":"1","_rn_":"14"},{"1":"soy_47","2":"86.20738","3":"13.7926241","4":"8","_rn_":"42"},{"1":"soy_7","2":"75.82929","3":"24.1707059","4":"15","_rn_":"48"},{"1":"soy_12","2":"65.74042","3":"34.2595750","4":"22","_rn_":"4"},{"1":"soy_9","2":"56.41083","3":"43.5891679","4":"29","_rn_":"50"},{"1":"soy_16","2":"44.38025","3":"55.6197521","4":"36","_rn_":"8"},{"1":"soy_33","2":"32.21538","3":"67.7846199","4":"43","_rn_":"27"},{"1":"soy_31","2":"10.32248","3":"89.6775189","4":"50","_rn_":"25"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sad</span>(soy_rust, <span class="at">n =</span> <span class="dv">12</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span></code></pre></div>
<img src="code_files/figure-html/sad-3.png" width="960" />
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["img"],"name":[1],"type":["chr"],"align":["left"]},{"label":["healthy"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["symptomatic"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["rank"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"soy_21","2":"99.75300","3":"0.2469962","4":"1","_rn_":"14"},{"1":"soy_48","2":"91.65338","3":"8.3466151","4":"5","_rn_":"43"},{"1":"soy_10","2":"85.33469","3":"14.6653082","4":"9","_rn_":"2"},{"1":"soy_17","2":"78.48053","3":"21.5194736","4":"14","_rn_":"9"},{"1":"soy_30","2":"72.82859","3":"27.1714096","4":"18","_rn_":"24"},{"1":"soy_14","2":"65.67188","3":"34.3281239","4":"23","_rn_":"6"},{"1":"soy_40","2":"59.42983","3":"40.5701743","4":"27","_rn_":"35"},{"1":"soy_43","2":"52.04795","3":"47.9520477","4":"32","_rn_":"38"},{"1":"soy_16","2":"44.38025","3":"55.6197521","4":"36","_rn_":"8"},{"1":"soy_28","2":"33.83941","3":"66.1605855","4":"41","_rn_":"21"},{"1":"soy_32","2":"26.42826","3":"73.5717374","4":"45","_rn_":"26"},{"1":"soy_31","2":"10.32248","3":"89.6775189","4":"50","_rn_":"25"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="using-an-rgb-based-index" class="section level4" number="18.4.1.3">
<h4><span class="header-section-number">18.4.1.3</span> Using an RGB-based index</h4>
<p>Another way to compute the diased area is by using an RGB-based phenotyping (Alves et al., 2021)[Alves KS, Guimarães M, Ascari JP, et al (2021) RGB-based phenotyping of foliar disease severity under controlled conditions. Trop Plant Pathol 1–13. <a href="https://doi.org/10.1007/S40858-021-00448-Y" class="uri">https://doi.org/10.1007/S40858-021-00448-Y</a>]. The first step is to find a suitable index for disease segmentation.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;soy_1.jpg&quot;</span>, <span class="at">path =</span> path_soy, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/rgb6-1.png" width="960" /></p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="co"># find a suitable index to segment disease and healthy tissues</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="fu">image_segment</span>(img, <span class="at">index =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/rgb6-2.png" width="960" /></p>
<p>The NGRDI (Normalized green red difference index) computed as <span class="math inline">\(G-R/G+R\)</span> seems to segment lesions from healthy areas satisfactorily. Next, I <code>plot()</code> the output of <code>image_index()</code> to find a suitable threshold.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a threshold</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>img_ind <span class="ot">&lt;-</span> <span class="fu">image_index</span>(img, <span class="at">index =</span> <span class="st">&quot;NGRDI&quot;</span>, <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(img_ind)</span></code></pre></div>
<p><img src="code_files/figure-html/rgb7-1.png" width="768" /></p>
<p>A threshold of <code>0</code> has been chosen. So, the next step is to use the function <code>measure_disease()</code> now. In this approach, color palettes are not informed. Instead, the user needs to declare two other arguments: <code>index_lb</code> to segment leaf from the background and <code>index_dh</code> to segment diseased from healthy tissues.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>  soy_rust2 <span class="ot">&lt;-</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">measure_disease</span>(<span class="at">pattern =</span> <span class="st">&quot;soy_&quot;</span>,</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index_lb =</span> <span class="st">&quot;G&quot;</span>, <span class="co"># segment leaf from background</span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index_dh =</span> <span class="st">&quot;NGRDI&quot;</span>, <span class="co"># segment diseased from healthy tissues</span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">threshold =</span> <span class="fu">c</span>(<span class="st">&quot;Otsu&quot;</span>, <span class="dv">0</span>),</span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dir_original =</span> rust_path,</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Image processing using multiple sessions (6). Please wait.</span></span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a><span class="do">##   usuário   sistema decorrido </span></span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a><span class="do">##      0.22      0.05     14.83</span></span></code></pre></div>
</div>
</div>
<div id="bean-angular-spot" class="section level3" number="18.4.2">
<h3><span class="header-section-number">18.4.2</span> Bean angular spot</h3>
<div id="using-sample-palettes-1" class="section level4" number="18.4.2.1">
<h4><span class="header-section-number">18.4.2.1</span> Using sample palettes</h4>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># image directory</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>path_bean <span class="ot">&lt;-</span> <span class="st">&quot;./data/disease_severity/bean_spot&quot;</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>bean_leaves <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">&quot;bean&quot;</span>, <span class="at">path =</span> path_bean)</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(bean_leaves, <span class="at">ncol =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/batch4-1.png" width="960" /></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>bean_path <span class="ot">&lt;-</span> <span class="st">&quot;./data/disease_severity/bean_spot&quot;</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>  bean_spot <span class="ot">&lt;-</span></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">measure_disease</span>(<span class="at">pattern =</span> <span class="st">&quot;bean&quot;</span>,</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">img_symptoms =</span> <span class="st">&quot;disease&quot;</span>,</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">img_healthy =</span> <span class="st">&quot;health&quot;</span>,</span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">img_background =</span> <span class="st">&quot;back&quot;</span>,</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dir_original =</span> bean_path,</span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dir_processed =</span> <span class="fu">paste0</span>(bean_path, <span class="st">&quot;/processed&quot;</span>),</span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">save_image =</span> <span class="cn">TRUE</span>,</span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">show_contour =</span> <span class="cn">FALSE</span>,</span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb176-14"><a href="#cb176-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Image processing using multiple sessions (6). Please wait.</span></span>
<span id="cb176-15"><a href="#cb176-15" aria-hidden="true" tabindex="-1"></a><span class="do">##   usuário   sistema decorrido </span></span>
<span id="cb176-16"><a href="#cb176-16" aria-hidden="true" tabindex="-1"></a><span class="do">##      0.22      0.03      6.16</span></span>
<span id="cb176-17"><a href="#cb176-17" aria-hidden="true" tabindex="-1"></a>bean_spot<span class="sc">$</span>severity</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["img"],"name":[1],"type":["chr"],"align":["left"]},{"label":["healthy"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["symptomatic"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"bean_F1","2":"98.73803","3":"1.2619739"},{"1":"bean_F10","2":"99.52920","3":"0.4707965"},{"1":"bean_F11","2":"73.03464","3":"26.9653631"},{"1":"bean_F12","2":"90.53231","3":"9.4676943"},{"1":"bean_F13","2":"86.84985","3":"13.1501461"},{"1":"bean_F14","2":"87.18206","3":"12.8179408"},{"1":"bean_F15","2":"86.41443","3":"13.5855687"},{"1":"bean_F16","2":"27.21220","3":"72.7878046"},{"1":"bean_F17","2":"99.84160","3":"0.1584034"},{"1":"bean_F18","2":"92.53584","3":"7.4641612"},{"1":"bean_F19","2":"90.23746","3":"9.7625408"},{"1":"bean_F2","2":"84.66370","3":"15.3363010"},{"1":"bean_F3","2":"76.47778","3":"23.5222190"},{"1":"bean_F4","2":"82.00788","3":"17.9921241"},{"1":"bean_F5","2":"94.70969","3":"5.2903059"},{"1":"bean_F6","2":"97.66191","3":"2.3380878"},{"1":"bean_F7","2":"99.08213","3":"0.9178701"},{"1":"bean_F8","2":"75.11693","3":"24.8830739"},{"1":"bean_F9","2":"77.07878","3":"22.9212154"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># image directory</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>path_bean_proc <span class="ot">&lt;-</span> <span class="st">&quot;./data/disease_severity/bean_spot/processed&quot;</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>bean_proc <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="at">pattern =</span> <span class="st">&quot;proc&quot;</span>, <span class="at">path =</span> path_bean_proc)</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="fu">image_combine</span>(bean_proc, <span class="at">ncol =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/batch6-1.png" width="960" /></p>
</div>
<div id="using-an-rgb-based-index-1" class="section level4" number="18.4.2.2">
<h4><span class="header-section-number">18.4.2.2</span> Using an RGB-based index</h4>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>img_bean <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;bean_F3.jpg&quot;</span>, <span class="at">path =</span> path_bean, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/beanleaf-1.png" width="960" /></p>
<p>First, we need to choose an index to segment the leaf from the background. The <code>image_segment()</code> function is used again.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image_segment</span>(img_bean, <span class="at">index =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/segbean2-1.png" width="960" /></p>
<p>Let’s try to use the <code>NB</code> index to segment the leaf and background, and the <code>NGRDI</code> again to segment lesion and healthy tissues.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>seg <span class="ot">&lt;-</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_segment_iter</span>(img_bean,</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;NB&quot;</span>, <span class="st">&quot;NGRDI&quot;</span>),</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nseg =</span> <span class="dv">2</span>,</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a><span class="do">##      image pixels   percent</span></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 original 600000 100.00000</span></span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     seg1 185067  30.84450</span></span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     seg2  51525  27.84127</span></span></code></pre></div>
<p><img src="code_files/figure-html/segiter-1.png" width="960" /></p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a threshold</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>img_ind <span class="ot">&lt;-</span> <span class="fu">image_index</span>(seg<span class="sc">$</span>images<span class="sc">$</span>seg1,</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">index =</span> <span class="st">&quot;NGRDI&quot;</span>,</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">resize =</span> <span class="cn">FALSE</span>,</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(img_ind)</span></code></pre></div>
<p><img src="code_files/figure-html/segthresh-1.png" width="768" /></p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>  bean_spot2 <span class="ot">&lt;-</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">measure_disease</span>(<span class="at">pattern =</span> <span class="st">&quot;bean&quot;</span>,</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index_lb =</span> <span class="st">&quot;NB&quot;</span>,</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index_dh =</span> <span class="st">&quot;NGRDI&quot;</span>,</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">threshold =</span> <span class="fu">c</span>(<span class="st">&quot;Otsu&quot;</span>, <span class="dv">0</span>),</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dir_original =</span> bean_path,</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">show_image =</span> <span class="cn">FALSE</span>,</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Image processing using multiple sessions (6). Please wait.</span></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a><span class="do">##   usuário   sistema decorrido </span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a><span class="do">##      0.20      0.08      2.73</span></span></code></pre></div>
</div>
</div>
</div>
<div id="concordance-correlation-coefficient" class="section level2" number="18.5">
<h2><span class="header-section-number">18.5</span> Concordance correlation coefficient</h2>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>disease <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;./data/disease_severity/disease.xlsx&quot;</span>)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(disease,</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span> <span class="dv">1</span>,</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color =</span> disease, <span class="at">fill =</span> disease),</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">axisLabels =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">&quot;Assess&quot;</span>, <span class="st">&quot;palettes&quot;</span>, <span class="st">&quot;RGB&quot;</span>),</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> custom_smoth),</span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> custom_ccc),</span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">diag =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">&quot;densityDiag&quot;</span>,</span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">alpha =</span>  <span class="fl">0.7</span>,</span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">size =</span> <span class="fl">0.2</span>,</span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">color =</span> <span class="st">&quot;black&quot;</span>))) <span class="sc">+</span></span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_theme</span>()</span></code></pre></div>
<p><img src="code_files/figure-html/corcordance-1.png" width="768" /></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;figs/disease_severity.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>)</span></code></pre></div>
</div>
<div id="lesion-features" class="section level2" number="18.6">
<h2><span class="header-section-number">18.6</span> Lesion features</h2>
<p>In this example, I will use a sample of leaf with symptoms of soybean rust (<em>Phakopsora pachyrhizi</em>).</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>lesion <span class="ot">&lt;-</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_import</span>(<span class="st">&quot;./data/disease_severity/soybean_rust/rust.png&quot;</span>,</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/features1-1.png" width="768" /></p>
<p>Here, an RGB-based index will be used to segment the diseased and healthy tissues. The first step is to choose an appropriate index.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image_segment</span>(lesion, <span class="at">index =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/features2-1.png" width="960" /></p>
<p>Both <code>"NGRDI"</code> and <code>"VARI"</code> provided satisfactory segmentation. So, the <code>"NGRDI"</code> will be chosen. The next step is to use the function <code>measure_disease()</code> with the argument <code>index_dh</code>. Note that <code>index_lb</code> is not mandatory and will not be used here, since the image has no background.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>les <span class="ot">&lt;-</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">measure_disease</span>(lesion,</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index_dh =</span> <span class="st">&quot;NGRDI&quot;</span>)</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning in if (threshold == &quot;Otsu&quot;) {: a condição tem comprimento &gt; 1 e somente</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="do">## o primeiro elemento será usado</span></span></code></pre></div>
<p><img src="code_files/figure-html/unnamed-chunk-17-1.png" width="960" /></p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>les<span class="sc">$</span>severity</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["healthy"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["symptomatic"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"85.89737","2":"14.10263"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The results show satisfactory results. All lesions were identified and the severity, in this case, was ~14%.</p>
<p>By default, Otsu’s thresholding method is used. Bellow, we can see which was the threshold value used in the segmentation.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>index_lesion <span class="ot">&lt;-</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_index</span>(lesion,</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">index =</span> <span class="st">&quot;NGRDI&quot;</span>,</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">resize =</span> <span class="cn">FALSE</span>,</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">show_image =</span> <span class="cn">FALSE</span>)</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>EBImage<span class="sc">::</span><span class="fu">otsu</span>(index_lesion<span class="sc">$</span>NGRDI, <span class="at">range =</span> <span class="fu">range</span>(index_lesion<span class="sc">$</span>NGRDI))</span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -0.007994186</span></span></code></pre></div>
<p>Users can set the argument <code>threshold</code> to provide more reliable segmentations. If any non-numeric value different than <code>"Otsu"</code> is provided in the <code>threshold</code> argument, an iterative section will be open so that users can choose a threshold value. In this case, I will simply plot the index computed above.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(index_lesion)</span></code></pre></div>
<p><img src="code_files/figure-html/features4-1.png" width="768" /></p>
<p>In this example, negative values of <code>NGRDI</code> are attributed to diseased tissues and positive to healthy tissues. Let’s see how the results (both for severity and number of lesions) change when the <code>threshold</code> argument is used. To do that, the arguments <code>watershed = TRUE</code>(implement the watershed segmentation algorithm) and <code>show_features = TRUE</code> (compute lesions’ features) will be used.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>les2 <span class="ot">&lt;-</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">measure_disease</span>(lesion,</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index_dh =</span> <span class="st">&quot;NGRDI&quot;</span>,</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">threshold =</span> <span class="fl">0.1</span>,</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">TRUE</span>,</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_features =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/features5-1.png" width="960" /></p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>les2<span class="sc">$</span>severity</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["healthy"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["symptomatic"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"76.28737","2":"23.71263"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>les2<span class="sc">$</span>statistics</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["stat"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"n","2":"161.0000"},{"1":"min_area","2":"24.0000"},{"1":"mean_area","2":"278.8261"},{"1":"max_area","2":"2309.0000"},{"1":"sd_area","2":"283.3717"},{"1":"sum_area","2":"44891.0000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>les3 <span class="ot">&lt;-</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">measure_disease</span>(lesion,</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">index_dh =</span> <span class="st">&quot;NGRDI&quot;</span>,</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">threshold =</span> <span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">watershed =</span> <span class="cn">TRUE</span>,</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show_features =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/feature6-1.png" width="960" /></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>les3<span class="sc">$</span>severity</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["healthy"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["symptomatic"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"90.13789","2":"9.862105"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>les3<span class="sc">$</span>statistics</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["stat"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"n","2":"147.00000"},{"1":"min_area","2":"23.00000"},{"1":"mean_area","2":"127.55102"},{"1":"max_area","2":"408.00000"},{"1":"sd_area","2":"69.50463"},{"1":"sum_area","2":"18750.00000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="benchmarking-1" class="section level2" number="18.7">
<h2><span class="header-section-number">18.7</span> Benchmarking</h2>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>bench <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">&quot;./data/disease_severity/time.xlsx&quot;</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bench, <span class="fu">aes</span>(resolution, avg, <span class="at">fill =</span> strategy)) <span class="sc">+</span></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span>  <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>))) <span class="sc">+</span></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(avg, <span class="dv">2</span>)),</span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_theme</span>() <span class="sc">+</span></span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Filter&quot;</span>,</span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Processing<span class="sc">~</span>time<span class="sc">~</span>(s<span class="sc">~</span>image<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>})))</span></code></pre></div>
<p><img src="code_files/figure-html/benchmarking2-1.png" width="960" /></p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;figs/benchmarking_sev.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="fl">4.5</span>)</span></code></pre></div>
</div>
<div id="challenges" class="section level2" number="18.8">
<h2><span class="header-section-number">18.8</span> Challenges</h2>
<div id="low-contrasting-lesions" class="section level3" number="18.8.1">
<h3><span class="header-section-number">18.8.1</span> low-contrasting lesions</h3>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>path_challenge <span class="ot">&lt;-</span> <span class="st">&quot;./data/disease_severity/challenges&quot;</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>pepper <span class="ot">&lt;-</span> <span class="fu">image_import</span>(<span class="st">&quot;pepper.png&quot;</span>,</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">path =</span> path_challenge,</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/challenge1-1.png" width="960" /></p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image_index</span>(pepper, <span class="at">index =</span> <span class="st">&quot;all&quot;</span>, <span class="at">resize =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/challenge1-2.png" width="960" /></p>
</div>
<div id="complex-backgrounds" class="section level3" number="18.8.2">
<h3><span class="header-section-number">18.8.2</span> Complex backgrounds</h3>
<p>Segmenting the leaf from complex backgrounds is a challenge In the following example, a maize leaf needs to be segmented from the background that contains both green leaves (similar to leaf) and soil (similar to the disease).</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">&lt;-</span> </span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_import</span>(<span class="st">&quot;maize_1.png&quot;</span>,</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">path =</span> path_challenge,</span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/challenge2-1.png" width="960" /></p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">image_segment</span>(img, <span class="at">index =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/challenge2-2.png" width="960" /></p>
<p>In the following example, the background has a similar color to the midrib. In this case, cropping the image so that the background is removed would solve the issue.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>img2 <span class="ot">&lt;-</span> </span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_import</span>(<span class="st">&quot;maize_2.png&quot;</span>,</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">path =</span> path_challenge,</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/challenge3-1.png" width="960" /></p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="fu">image_segment</span>(img2, <span class="at">index =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/challenge3-2.png" width="960" /></p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="co"># crop the image to isolate the background</span></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>img2_crop <span class="ot">&lt;-</span> <span class="fu">image_crop</span>(img2,</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">width =</span> <span class="dv">959</span><span class="sc">:</span><span class="dv">32</span>,</span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">height =</span> <span class="dv">163</span><span class="sc">:</span><span class="dv">557</span>,</span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/challenge3-3.png" width="960" /></p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">image_segment</span>(img2_crop)</span></code></pre></div>
<p><img src="code_files/figure-html/challenge3-4.png" width="960" /></p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="co"># use the NR index and invert the segmentation to isolate the diseased tissues</span></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a><span class="fu">measure_disease</span>(img2_crop, </span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">index_dh =</span> <span class="st">&quot;NR&quot;</span>,</span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">invert =</span> <span class="cn">TRUE</span>)</span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning in if (threshold == &quot;Otsu&quot;) {: a condição tem comprimento &gt; 1 e somente</span></span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a><span class="do">## o primeiro elemento será usado</span></span></code></pre></div>
<p><img src="code_files/figure-html/challenge3-5.png" width="960" /></p>
<pre><code>## $severity
##    healthy symptomatic
## 1 93.16647    6.833533
## 
## $shape
## NULL
## 
## $statistics
## NULL
## 
## attr(,&quot;class&quot;)
## [1] &quot;plm_disease&quot;</code></pre>
<p>In the following image gathered from Barbedo (2016)<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> is shown an example of an image containing specular reflections and several light/shadow transitions. Segmenting the leaf, in this case, is very difficult.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>img3 <span class="ot">&lt;-</span> </span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">image_import</span>(<span class="st">&quot;maize.jpg&quot;</span>,</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">path =</span> path_challenge,</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/challenge4-1.png" width="960" /></p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image_segment</span>(img3, <span class="at">index =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<p><img src="code_files/figure-html/challenge4-2.png" width="960" /></p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Silva LJ da, Medeiros AD de, Oliveira AMS (2019) SeedCalc, a new automated R software tool for germination and seedling length data processing. J Seed Sci 41:250–257. <a href="https://doi.org/10.1590/2317-1545V42N2217267" class="uri">https://doi.org/10.1590/2317-1545V42N2217267</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Gupta, S., Rosenthal, D. M., Stinchcombe, J. R., &amp; Baucom, R. S. (2020). The remarkable morphological diversity of leaf shape in sweet potato (<em>Ipomoea batatas</em>): the influence of genetics, environment, and G×E. <em>New Phytologist</em>, 225(5), 2183–2195. <a href="https://doi.org/10.1111/nph.16286" class="uri">https://doi.org/10.1111/nph.16286</a><a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Barbedo, J. G. A. (2016). A review on the main challenges in automatic plant disease identification based on visible range images. Biosystems Engineering, 144, 52–60. <a href="doi:10.1016/J.BIOSYSTEMSENG.2016.01.017" class="uri">doi:10.1016/J.BIOSYSTEMSENG.2016.01.017</a><a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
		$('#content img:not(.no-lightbox)').addClass("image-lb");
	$('#content').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
	    delegate: '.image-lb',
	    gallery: {enabled: true },
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
